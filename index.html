<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bleachers & Seats - Operations Platform</title>
    <link rel="stylesheet" href="css/app.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-branding">
            <div class="login-logo login-logo-animate">
                <img src="bleachers-logo-icon.png" alt="Bleachers & Seats">
            </div>
            <img src="menu-logo-wide.png" alt="Bleachers & Seats" style="max-width: 280px; margin: 0 auto 8px; display: block;">
            <p class="login-subtitle">Professional, Accurate, On-Time</p>
        </div>
        <div id="clerk-sign-in"></div>
    </div>

    <!-- Office Dashboard -->
    <div id="officeDashboard" class="hidden">
        <div class="app-layout">
            <button class="mobile-menu-btn" onclick="toggleMobileMenu('officeSidebar')">
                <img src="bleachers-logo-icon.png" alt="Menu">
            </button>
            <div class="sidebar-backdrop" id="officeSidebarBackdrop" onclick="closeMobileMenu('officeSidebar')"></div>
            <div class="sidebar" id="officeSidebar">
                <div class="sidebar-header" onclick="toggleSidebar('officeSidebar')">
                    <img src="bleachers-logo-icon.png" alt="Bleachers & Seats" class="sidebar-logo-icon">
                    <img src="menu-logo-wide.png" alt="Bleachers & Seats" class="sidebar-logo-full">
                    <div class="sidebar-close-btn">‚úï</div>
                </div>
                <div class="sidebar-nav">
                    <!-- Home -->
                    <div class="nav-item active" data-view="home" onclick="showView('home')">
                        <span>üè†</span>
                        <span>Home</span>
                    </div>

                    <!-- Search -->
                    <div class="nav-item" data-view="officeSearch" onclick="showView('officeSearch')">
                        <span>üîç</span>
                        <span>Search</span>
                    </div>

                    <!-- Sales -->
                    <div class="sidebar-divider" style="margin: 12px 20px; border-top: 1px solid rgba(255,255,255,0.15); position: relative;">
                        <span style="position: absolute; top: -8px; left: 50%; transform: translateX(-50%); background: #2d3748; padding: 0 8px; font-size: 10px; color: rgba(255,255,255,0.4); white-space: nowrap; text-transform: uppercase; letter-spacing: 1px;">Sales</span>
                    </div>
                    <div class="nav-item" data-view="salesPipeline" onclick="showView('salesPipeline')">
                        <span>üíº</span>
                        <span>Pipeline</span>
                    </div>
                    <div class="nav-item" data-view="accounts" onclick="showView('accounts')">
                        <span>üè´</span>
                        <span>Accounts</span>
                    </div>

                    <!-- Procurement -->
                    <div class="sidebar-divider" style="margin: 12px 20px; border-top: 1px solid rgba(255,255,255,0.15); position: relative;">
                        <span style="position: absolute; top: -8px; left: 50%; transform: translateX(-50%); background: #2d3748; padding: 0 8px; font-size: 10px; color: rgba(255,255,255,0.4); white-space: nowrap; text-transform: uppercase; letter-spacing: 1px;">Procurement</span>
                    </div>
                    <div class="nav-item" data-view="opsReview" onclick="showView('opsReview')">
                        <span>üìã</span>
                        <span>Ops Review <span id="opsReviewBadge" class="badge" style="background: #fff3e0; color: #e65100; margin-left: 4px; font-size: 10px; padding: 2px 6px;">0</span></span>
                    </div>
                    <div class="nav-item" data-view="estimates" onclick="showView('estimates')">
                        <span>üí∞</span>
                        <span>Estimates</span>
                    </div>
                    <!-- Logistics -->
                    <div class="sidebar-divider" style="margin: 12px 20px; border-top: 1px solid rgba(255,255,255,0.15); position: relative;">
                        <span style="position: absolute; top: -8px; left: 50%; transform: translateX(-50%); background: #2d3748; padding: 0 8px; font-size: 10px; color: rgba(255,255,255,0.4); white-space: nowrap; text-transform: uppercase; letter-spacing: 1px;">Logistics</span>
                    </div>
                    <div class="nav-item" data-view="jobs" onclick="showView('jobs')">
                        <span>üõ†Ô∏è</span>
                        <span>Jobs</span>
                    </div>
                    <div class="nav-item" data-view="scheduling" onclick="showView('scheduling')">
                        <span>üìÖ</span>
                        <span>Scheduling</span>
                    </div>
                    <div class="nav-item" data-view="projects" onclick="showView('projects')">
                        <span>üìä</span>
                        <span>Project Tracker</span>
                    </div>

                    <!-- Resources -->
                    <div class="sidebar-divider" style="margin: 12px 20px; border-top: 1px solid rgba(255,255,255,0.15); position: relative;">
                        <span style="position: absolute; top: -8px; left: 50%; transform: translateX(-50%); background: #2d3748; padding: 0 8px; font-size: 10px; color: rgba(255,255,255,0.4); white-space: nowrap; text-transform: uppercase; letter-spacing: 1px;">Resources</span>
                    </div>
                    <div class="nav-item" data-view="parts" onclick="showView('parts')">
                        <span>üîß</span>
                        <span>Parts Catalog</span>
                    </div>
                    <div class="nav-item" data-view="resources" onclick="showView('resources')">
                        <span>üìö</span>
                        <span>Employee Resources</span>
                    </div>

                    <!-- Bottom-aligned items -->
                    <div class="sidebar-spacer"></div>

                    <!-- Settings (Office + Admin) -->
                    <div class="nav-item" data-view="settings" onclick="showView('settings')">
                        <span>‚öôÔ∏è</span>
                        <span>Settings</span>
                    </div>
                </div>
                <div class="sidebar-footer">
                    <div class="user-info" onclick="logout()">
                        <div class="user-avatar" id="officeUserAvatar">OM</div>
                        <div>
                            <div style="font-size: 14px; font-weight: 600;" id="officeUserName">Office Manager</div>
                            <div style="font-size: 12px; opacity: 0.7;">Logout</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="main-content">
                <div class="content-area">
                    <!-- Home View -->
                    <div id="homeView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Home</h1>
                            <p class="page-subtitle">Welcome back</p>
                        </div>

                        <!-- Company Bulletin Board -->
                        <div id="bulletinBoard" class="bulletin-board">
                            <!-- Populated by JS -->
                        </div>

                        <!-- Two Column: Notifications + Needs Attention -->
                        <div class="home-panels">
                            <div class="home-panel" id="notificationsPanel">
                                <!-- Populated by JS -->
                            </div>
                            <div class="home-panel" id="attentionPanel">
                                <!-- Populated by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Estimates View -->
                    <div id="estimatesView" class="hidden">
                        <div class="page-header">
                            <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px;">
                                <div>
                                    <h1 class="page-title">Estimates</h1>
                                    <p class="page-subtitle">Manage customer estimates and create new ones</p>
                                </div>
                                <a href="https://app.qbo.intuit.com" target="_blank" rel="noopener" class="btn btn-outline" style="font-size: 13px; display: flex; align-items: center; gap: 6px; white-space: nowrap;">
                                    Open QuickBooks ‚Üó
                                </a>
                            </div>
                        </div>

                        <!-- Filter Tabs -->
                        <div style="display: flex; gap: 0; margin-bottom: 20px; border-bottom: 2px solid #e9ecef;">
                            <button class="schedule-tab active" onclick="filterEstimates('all')" id="estFilterAll">All</button>
                            <button class="schedule-tab" onclick="filterEstimates('pending')" id="estFilterPending">Pending Estimates <span id="estPendingCount" class="badge" style="background: #fff3e0; color: #e65100; margin-left: 6px;">0</span></button>
                            <button class="schedule-tab" onclick="filterEstimates('accepted')" id="estFilterAccepted">Accepted Estimates <span id="estAcceptedCount" class="badge" style="background: #c8e6c9; color: #2e7d32; margin-left: 6px;">0</span></button>
                            <button class="schedule-tab" onclick="filterEstimates('create')" id="estFilterCreate">+ Create Estimate</button>
                        </div>

                        <!-- All Tab Content -->
                        <div id="estimatesAllTab">
                            <div style="margin-bottom: 20px;">
                                <input type="text" id="allEstimateSearch" class="form-input" placeholder="Search all estimates..." oninput="loadEstimatesList()" style="max-width: 450px;">
                            </div>
                            <div class="card">
                                <div class="card-body" id="allEstimatesList" style="padding: 0;">
                                    <!-- Populated by JavaScript -->
                                </div>
                            </div>
                        </div>

                        <!-- Pending Tab Content -->
                        <div id="estimatesPendingTab" class="hidden">
                            <div style="margin-bottom: 20px;">
                                <input type="text" id="estimateSearch" class="form-input" placeholder="Search estimates by customer, location, or job number..." oninput="loadEstimatesList()" style="max-width: 450px;">
                            </div>
                            <div class="card">
                                <div class="card-body" id="estimatesList" style="padding: 0;">
                                    <!-- Populated by JavaScript -->
                                </div>
                            </div>
                        </div>

                        <!-- Accepted Tab Content -->
                        <div id="estimatesAcceptedTab" class="hidden">
                            <div style="margin-bottom: 20px;">
                                <input type="text" id="acceptedEstimateSearch" class="form-input" placeholder="Search accepted estimates..." oninput="loadEstimatesList()" style="max-width: 450px;">
                            </div>
                            <div class="card">
                                <div class="card-body" id="acceptedEstimatesList" style="padding: 0;">
                                    <!-- Populated by JavaScript -->
                                </div>
                            </div>
                        </div>

                        <!-- Create Tab Content -->
                        <div id="estimatesCreateTab" class="hidden">
                            <div class="card">
                                <div class="card-body" id="createEstimateForm">
                                    <!-- Populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Estimate Detail View -->
                    <div id="estimateDetailView" class="hidden">
                        <div class="page-header">
                            <button class="btn btn-secondary" onclick="showView('estimates')">‚Üê Back to Estimates</button>
                        </div>
                        <div id="estimateDetailContent"></div>
                    </div>

                    <!-- Sales Pipeline View -->
                    <div id="salesPipelineView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Pipeline</h1>
                            <p class="page-subtitle">Track estimates from creation to acceptance</p>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <input type="text" id="salesPipelineSearch" class="form-input" placeholder="Search by customer, location, or job number..." oninput="loadSalesPipeline()" style="max-width: 500px;">
                        </div>

                        <!-- Territory Filter Tabs -->
                        <div style="display: flex; gap: 0; margin-bottom: 8px; border-bottom: 1px solid #dee2e6;">
                            <button class="schedule-tab small active" onclick="filterPipelineTerritory('all')" id="pipelineTerritoryAll">All</button>
                            <button class="schedule-tab small" onclick="filterPipelineTerritory('Original')" id="pipelineTerritoryOriginal">Original (KY/TN)</button>
                            <button class="schedule-tab small" onclick="filterPipelineTerritory('Southern')" id="pipelineTerritorySouthern">Southern (AL/FL)</button>
                            <button class="schedule-tab small" onclick="filterPipelineTerritory('new')" id="pipelineTerritoryNew">New Installs</button>
                        </div>

                        <div id="salesPipelineContent">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Projects View (Project Tracker) -->
                    <div id="projectsView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Project Tracker</h1>
                            <p class="page-subtitle">Track all active projects from PO received to completion</p>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <input type="text" id="pipelineSearch" class="form-input" placeholder="Search projects by customer, location, job number, or description..." oninput="loadPipeline()" style="max-width: 500px;">
                        </div>

                        <div id="pipelineContent">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Parts Catalog View -->
                    <div id="partsView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Parts Catalog</h1>
                            <p class="page-subtitle">Search parts across all vendors for pricing and info</p>
                        </div>

                        <div class="card">
                            <div class="card-body">
                                <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                                    <input type="text" id="officePartSearchInput" class="form-input" placeholder="Search by part name, number, or description..." style="font-size: 16px; padding: 14px 16px; flex: 1;" oninput="searchOfficeParts()">
                                    <select id="officePartVendorFilter" class="form-input" style="width: 200px;" onchange="searchOfficeParts()">
                                        <option value="">All Vendors</option>
                                        <option value="Hussey">Hussey Seating Co</option>
                                        <option value="Draper">Draper (coming soon)</option>
                                    </select>
                                </div>
                                <div id="officePartSearchResults" style="margin-top: 16px;">
                                    <div style="text-align: center; padding: 40px; color: #6c757d;">Enter a part name, number, or description to search the catalog</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Employee Resources View -->
                    <div id="resourcesView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Employee Resources</h1>
                            <p class="page-subtitle">Company guides and reference materials</p>
                        </div>
                        <div class="card">
                            <div class="card-body">
                                <div style="display: flex; align-items: center; gap: 16px; padding: 16px; border: 1px solid #e9ecef; border-radius: 8px;">
                                    <span style="font-size: 32px;">üìÑ</span>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; font-size: 16px;">Employee Resource Guide</div>
                                        <div style="font-size: 13px; color: #6c757d; margin-top: 4px;">Company policies, procedures, and reference information</div>
                                    </div>
                                    <a href="https://acrobat.adobe.com/id/urn:aaid:sc:VA6C2:ac06edc3-d318-4f93-abc8-e4f281817ec9"
                                       target="_blank" class="btn btn-primary">Open Guide</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Jobs View (Tabbed: All | Backlog | This Week | Completed | Shit List) -->
                    <div id="jobsView" class="hidden">
                        <div class="page-header" style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 16px;">
                            <div>
                                <h1 class="page-title">Jobs</h1>
                                <p class="page-subtitle">Work orders and field operations</p>
                            </div>
                            <button class="btn btn-primary" onclick="showView('officeCreate')">+ Create Job</button>
                        </div>

                        <!-- Search Bar -->
                        <div style="margin-bottom: 16px;">
                            <input type="text" id="jobsSearchInput" class="form-input" placeholder="Search jobs by number, customer, or location..." oninput="searchJobs()" style="max-width: 400px;">
                        </div>

                        <!-- Territory Filter -->
                        <div style="display: flex; gap: 0; margin-bottom: 8px; border-bottom: 1px solid #dee2e6;">
                            <button class="schedule-tab small active" onclick="switchJobsTerritory('all')" id="jobsTerritoryAll">All Territories</button>
                            <button class="schedule-tab small" onclick="switchJobsTerritory('original')" id="jobsTerritoryOriginal">Original (KY/TN)</button>
                            <button class="schedule-tab small" onclick="switchJobsTerritory('southern')" id="jobsTerritorySouthern">Southern (AL/FL)</button>
                        </div>

                        <!-- Main Jobs Tabs -->
                        <div style="display: flex; gap: 0; margin-bottom: 20px; border-bottom: 2px solid #e9ecef;">
                            <button class="schedule-tab active" onclick="switchJobsTab('all')" id="jobsTabAll">All</button>
                            <button class="schedule-tab" onclick="switchJobsTab('backlog')" id="jobsTabBacklog">Backlog</button>
                            <button class="schedule-tab" onclick="switchJobsTab('completed')" id="jobsTabCompleted">Completed</button>
                            <button class="schedule-tab" onclick="switchJobsTab('shitList')" id="jobsTabShitList">Shit List</button>
                        </div>

                        <!-- Tab Content: All Jobs -->
                        <div id="jobsContentAll">
                            <div id="jobsListAll" style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);"></div>
                        </div>

                        <!-- Tab Content: Backlog (draft status, needs scheduling) -->
                        <div id="jobsContentBacklog" class="hidden">
                            <div style="background: #fff3e0; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <strong style="color: #e65100;">üìã Backlog</strong>
                                <span style="color: #6c757d; margin-left: 8px;">Draft work orders awaiting scheduling</span>
                            </div>
                            <div id="jobsListBacklog" style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);"></div>
                        </div>



                        <!-- Tab Content: Completed -->
                        <div id="jobsContentCompleted" class="hidden">
                            <div style="background: #e8f5e9; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <strong style="color: #2e7d32;">‚úÖ Completed</strong>
                                <span style="color: #6c757d; margin-left: 8px;">Finished work orders</span>
                            </div>
                            <div id="jobsListCompleted" style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);"></div>
                        </div>

                        <!-- Tab Content: Shit List (unable_to_complete from field) -->
                        <div id="jobsContentShitList" class="hidden">
                            <div style="background: #ffebee; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <strong style="color: #c62828;">üí© Shit List</strong>
                                <span style="color: #6c757d; margin-left: 8px;">Jobs marked "Unable to Complete" by field staff</span>
                            </div>
                            <div id="jobsListShitList" style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);"></div>
                        </div>
                    </div>

                    <!-- Accounts View -->
                    <div id="accountsView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Accounts</h1>
                            <p class="page-subtitle">Manage customer accounts and their locations</p>
                        </div>

                        <div style="margin-bottom: 24px;">
                            <button class="btn btn-primary" onclick="showAddCustomerModal()" style="margin-bottom: 16px;">+ New Customer</button>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <input type="text" id="accountSearch" class="form-input" placeholder="Search customers or locations..." oninput="filterAccounts()" style="max-width: 400px;">
                                <select id="accountTerritoryFilter" class="form-input" onchange="filterAccounts()" style="width: 180px;">
                                    <option value="">All Territories</option>
                                    <option value="Original">Original</option>
                                    <option value="Southern">Southern</option>
                                    <option value="House">House Account</option>
                                </select>
                                <select id="accountTypeFilter" class="form-input" onchange="filterAccounts()" style="width: 180px;">
                                    <option value="">All Types</option>
                                    <option value="county">County Schools</option>
                                    <option value="collegiate">Collegiate</option>
                                    <option value="private">Private School</option>
                                    <option value="contractor">Contractor</option>
                                    <option value="government">Government</option>
                                    <option value="worship">Worship</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Customer Accounts</h2>
                                <span id="accountCount" style="font-size: 14px; color: #6c757d;">6 customers</span>
                            </div>
                            <div class="card-body">
                                <div id="accountsList"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Detail View -->
                    <div id="customerDetailView" class="hidden">
                        <div class="page-header">
                            <button class="btn btn-secondary" onclick="showView('accounts')">‚Üê Back to Accounts</button>
                            <div style="display: flex; align-items: center; gap: 16px; margin-top: 16px;">
                                <h1 class="page-title" style="margin: 0;" id="custDetailName">Lauderdale County Schools</h1>
                                <span id="custDetailType" class="badge badge-info">County</span>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 24px;">
                            <!-- Customer Info -->
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Customer Information</h2>
                                </div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label">Address</label>
                                        <p id="custDetailAddress" style="font-size: 14px;">100 S Jefferson St, Ripley, TN 38063</p>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px;">
                                        <div class="form-group">
                                            <label class="form-label">Primary Contact</label>
                                            <p id="custDetailContact" style="font-size: 14px;"></p>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Phone</label>
                                            <p id="custDetailPhone" style="font-size: 14px;"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Stats -->
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Account Stats</h2>
                                </div>
                                <div class="card-body">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; text-align: center;">
                                        <div>
                                            <div style="font-size: 28px; font-weight: 700; color: #4CAF50;" id="custDetailLocations">4</div>
                                            <div style="font-size: 12px; color: #6c757d;">Locations</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 28px; font-weight: 700; color: #2196F3;" id="custDetailJobs">28</div>
                                            <div style="font-size: 12px; color: #6c757d;">Total Jobs</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 28px; font-weight: 700; color: #9C27B0;" id="custDetailRevenue">$45,230</div>
                                            <div style="font-size: 12px; color: #6c757d;">Revenue</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tabs -->
                        <div class="card">
                            <div class="card-header" style="border-bottom: none; padding-bottom: 0;">
                                <div style="display: flex; gap: 0;">
                                    <button class="btn" id="tabLocations" onclick="showCustomerTab('locations')" style="border-radius: 8px 8px 0 0; border-bottom: 3px solid #4CAF50;">Locations</button>
                                    <button class="btn" id="tabContacts" onclick="showCustomerTab('contacts')" style="border-radius: 8px 8px 0 0; background: transparent; color: #6c757d;">Contacts</button>
                                    <button class="btn" id="tabHistory" onclick="showCustomerTab('history')" style="border-radius: 8px 8px 0 0; background: transparent; color: #6c757d;">Service History</button>
                                    <button class="btn" id="tabEquipment" onclick="showCustomerTab('equipment')" style="border-radius: 8px 8px 0 0; background: transparent; color: #6c757d;">Equipment</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <!-- Locations Tab -->
                                <div id="customerLocationsTab">
                                    <div style="display: flex; justify-content: flex-end; margin-bottom: 16px;">
                                        <button class="btn btn-primary" onclick="showAddLocationModal()">+ Add Location</button>
                                    </div>
                                    <div id="custLocationsList"></div>
                                </div>

                                <!-- Contacts Tab (District-level) -->
                                <div id="customerContactsTab" class="hidden">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                        <p style="color: #6c757d; margin: 0;">District-level contacts (for contracts, billing, etc.)</p>
                                        <button class="btn btn-primary" onclick="showAddContactModal(currentCustomerId)">+ Add Contact</button>
                                    </div>
                                    <div id="custContactsList"></div>
                                </div>

                                <!-- Service History Tab -->
                                <div id="customerHistoryTab" class="hidden">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Job #</th>
                                                <th>Type</th>
                                                <th>Location</th>
                                                <th>Description</th>
                                                <th>Status</th>
                                                <th>Date</th>
                                            </tr>
                                        </thead>
                                        <tbody id="custHistoryList">
                                            <tr>
                                                <td><span class="part-number" style="color: #0066cc;">17208</span></td>
                                                <td>Repair</td>
                                                <td>Ripley High School</td>
                                                <td>GOAL 5: Labor to install safety strap</td>
                                                <td><span class="badge badge-success">Completed</span></td>
                                                <td>1/22/2026</td>
                                            </tr>
                                            <tr>
                                                <td><span class="part-number" style="color: #0066cc;">17175</span></td>
                                                <td>Service Call</td>
                                                <td>Ripley High School</td>
                                                <td>Main goal winch isn't operating correctly</td>
                                                <td><span class="badge badge-success">Completed</span></td>
                                                <td>1/22/2026</td>
                                            </tr>
                                            <tr>
                                                <td><span class="part-number" style="color: #0066cc;">15741</span></td>
                                                <td>Service Call</td>
                                                <td>Ripley High School</td>
                                                <td>2025 Indoor Bleacher Inspections</td>
                                                <td><span class="badge badge-success">Completed</span></td>
                                                <td>10/1/2025</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <!-- Equipment Tab -->
                                <div id="customerEquipmentTab" class="hidden">
                                    <div style="margin-bottom: 16px;">
                                        <p style="color: #6c757d; margin: 0;">Equipment inventory at each location</p>
                                    </div>
                                    <div id="custEquipmentList"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Ops Review View -->
                    <div id="opsReviewView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Ops Review</h1>
                            <p class="page-subtitle">Review submitted inspections and generate estimates</p>
                        </div>

                        <!-- Filter Tabs with Badges -->
                        <div style="display: flex; gap: 0; margin-bottom: 0; border-bottom: 2px solid #e9ecef;">
                            <button class="schedule-tab active" onclick="filterOpsReview('all')" id="opsFilterAll">All</button>
                            <button class="schedule-tab" onclick="filterOpsReview('submitted')" id="opsFilterSubmitted">Needs Review <span id="opsNeedsReviewCount" class="badge" style="background: #ffcdd2; color: #c62828; margin-left: 6px;">0</span></button>
                            <button class="schedule-tab" onclick="filterOpsReview('under_review')" id="opsFilterUnderReview">Under Review <span id="opsUnderReviewCount" class="badge" style="background: #fff3e0; color: #e65100; margin-left: 6px;">0</span></button>
                            <button class="schedule-tab" onclick="filterOpsReview('approved')" id="opsFilterApproved">Approved <span id="opsApprovedCount" class="badge" style="background: #c8e6c9; color: #2e7d32; margin-left: 6px;">0</span></button>
                        </div>

                        <!-- Approved Sub-Filters (shown when Approved tab is active) -->
                        <div id="approvedSubFilters" class="sub-filters hidden">
                            <button class="btn btn-sm active" onclick="filterApprovedSub('all')" id="subFilterAll" style="font-size: 12px; padding: 6px 12px;">All Approved</button>
                            <button class="btn btn-sm btn-outline" onclick="filterApprovedSub('awaiting_estimate')" id="subFilterAwaitingEst" style="font-size: 12px; padding: 6px 12px; border-color: #1565c0; color: #1565c0;">
                                Awaiting Estimate <span id="subAwaitingEstCount" class="badge" style="background: #e3f2fd; color: #1565c0; margin-left: 4px; font-size: 10px;">0</span>
                            </button>
                            <button class="btn btn-sm btn-outline" onclick="filterApprovedSub('complete')" id="subFilterComplete" style="font-size: 12px; padding: 6px 12px; border-color: #2e7d32; color: #2e7d32;">
                                Complete <span id="subCompleteCount" class="badge" style="background: #c8e6c9; color: #2e7d32; margin-left: 4px; font-size: 10px;">0</span>
                            </button>
                        </div>

                        <div class="card">
                            <div class="card-body" id="opsReviewList" style="padding: 0;"></div>
                        </div>
                    </div>

                    <!-- Ops Review Detail View (stays inside office dashboard) -->
                    <div id="opsReviewDetailView" class="hidden">
                        <div class="page-header">
                            <button class="btn btn-secondary" onclick="backToOpsReview()">‚Üê Back to Ops Review</button>
                        </div>
                        <div id="opsReviewDetailContent"></div>
                    </div>

                    <!-- Scheduling View -->
                    <div id="schedulingView" class="hidden">
                        <div class="page-header" style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <h1 class="page-title">Scheduling</h1>
                                <p class="page-subtitle">Crew and job assignments</p>
                            </div>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <button class="btn btn-outline" onclick="previousWeek()" style="padding: 8px 12px;">‚Üê Prev</button>
                                <span id="scheduleWeekLabel" style="font-weight: 600; min-width: 180px; text-align: center;">Week of Jan 6, 2025</span>
                                <button class="btn btn-outline" onclick="nextWeek()" style="padding: 8px 12px;">Next ‚Üí</button>
                                <button class="btn btn-primary" onclick="openAddEntryModal()">+ Add Entry</button>
                            </div>
                        </div>

                        <!-- Territory Tabs -->
                        <div style="display: flex; gap: 0; margin-bottom: 0; border-bottom: 2px solid #dee2e6;">
                            <button class="schedule-tab active" onclick="switchTerritory('original')" id="officeOriginalTab" style="font-weight: 700; font-size: 15px;">Original Territory (KY/TN)</button>
                            <button class="schedule-tab" onclick="switchTerritory('southern')" id="officeSouthernTab" style="font-weight: 700; font-size: 15px;">Southern Territory (AL/FL)</button>
                        </div>

                        <!-- Schedule Tabs -->
                        <div style="display: flex; gap: 0; margin-bottom: 20px; border-bottom: 2px solid #e9ecef; margin-top: 4px;">
                            <button class="schedule-tab active" onclick="switchScheduleTab('thisWeek')" id="thisWeekTab">Team Schedule</button>
                            <button class="schedule-tab" onclick="switchScheduleTab('officeThisWeek')" id="officeThisWeekTab">This Week</button>
                            <button class="schedule-tab" onclick="switchScheduleTab('planning')" id="planningTab">Planning</button>
                        </div>

                        <!-- Team Schedule View (weekly crew grid) -->
                        <div id="thisWeekView">
                            <div id="weeklyScheduleGrid"></div>
                        </div>

                        <!-- Office This Week View (card-based job tracker) -->
                        <div id="officeThisWeekView" class="hidden">
                            <div style="display: flex; gap: 12px; align-items: center; margin-bottom: 16px;">
                                <button class="btn btn-outline" onclick="prevOfficeJobsWeek()" style="padding: 8px 12px;">‚Üê Prev</button>
                                <span id="officeJobsWeekLabel" style="font-weight: 600; min-width: 180px; text-align: center;"></span>
                                <button class="btn btn-outline" onclick="nextOfficeJobsWeek()" style="padding: 8px 12px;">Next ‚Üí</button>
                            </div>
                            <div style="display: flex; gap: 0; margin-bottom: 20px; border-bottom: 2px solid #e9ecef;">
                                <button class="schedule-tab active" onclick="switchOfficeJobsTerritory('original')" id="officeJobsOriginalTab">Original Territory (KY/TN)</button>
                                <button class="schedule-tab" onclick="switchOfficeJobsTerritory('southern')" id="officeJobsSouthernTab">Southern Territory (AL/FL)</button>
                            </div>
                            <div id="officeJobsGrid"></div>
                        </div>

                        <!-- Planning View -->
                        <div id="planningView" class="hidden">
                            <div class="card" style="margin-bottom: 20px; background: #fffde7;">
                                <div class="card-body" style="padding: 16px;">
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <span style="font-size: 24px;">üìã</span>
                                        <div>
                                            <strong>Planning Mode</strong>
                                            <p style="font-size: 13px; color: #6c757d; margin-top: 2px;">Build next week's schedule here. Pull jobs from the Backlog or add manually.</p>
                                        </div>
                                        <button class="btn btn-success" style="margin-left: auto;" onclick="publishSchedule()">Publish Schedule</button>
                                    </div>
                                </div>
                            </div>
                            <div id="planningScheduleGrid"></div>
                        </div>

                        <!-- Add Entry Modal -->
                        <div id="addEntryModal" class="modal hidden">
                            <div class="modal-content" style="max-width: 600px;">
                                <div class="modal-header">
                                    <h2 class="modal-title">Add Schedule Entry</h2>
                                    <button class="modal-close" onclick="closeAddEntryModal()">√ó</button>
                                </div>
                                <div class="modal-body">
                                    <div class="form-group">
                                        <label class="form-label">Entry Type</label>
                                        <select id="entryType" class="form-input" onchange="toggleEntryFields()">
                                            <option value="job">Job from Backlog</option>
                                            <option value="note">Note (Holiday, Stop at Shop, etc.)</option>
                                            <option value="custom">Custom Entry</option>
                                        </select>
                                    </div>

                                    <!-- Job Selection -->
                                    <div id="jobEntryFields">
                                        <div class="form-group">
                                            <label class="form-label">Select Job</label>
                                            <select id="entryJobSelect" class="form-input">
                                                <option value="">-- Select a job --</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- Note Entry -->
                                    <div id="noteEntryFields" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">Note</label>
                                            <input type="text" id="entryNote" class="form-input" placeholder="e.g., Company Holiday, Alex Off, Stop at shop for parts">
                                        </div>
                                    </div>

                                    <!-- Custom Entry -->
                                    <div id="customEntryFields" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">School/Location</label>
                                            <input type="text" id="entrySchool" class="form-input" placeholder="School name">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Job Description</label>
                                            <textarea id="entryDescription" class="form-input" rows="3" placeholder="What work needs to be done"></textarea>
                                        </div>
                                    </div>

                                    <!-- Common Fields -->
                                    <div class="form-row">
                                        <div class="form-group" style="flex: 1;">
                                            <label class="form-label">Day</label>
                                            <select id="entryDay" class="form-input">
                                                <option value="mon">Monday</option>
                                                <option value="tue">Tuesday</option>
                                                <option value="wed">Wednesday</option>
                                                <option value="thu">Thursday</option>
                                                <option value="fri">Friday (Floating)</option>
                                            </select>
                                        </div>
                                        <div class="form-group" style="flex: 1;">
                                            <label class="form-label">Assigned To</label>
                                            <select id="entryTech" class="form-input">
                                                <option value="">-- Select tech(s) --</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group" style="flex: 1;">
                                            <label class="form-label">Parts Location</label>
                                            <input type="text" id="entryPartsLocation" class="form-input" placeholder="TN Shop, School, etc.">
                                        </div>
                                        <div class="form-group" style="flex: 1;">
                                            <label class="form-label">Confirmation</label>
                                            <select id="entryConfirmation" class="form-input">
                                                <option value="">Not confirmed</option>
                                                <option value="X">X - Attempted</option>
                                                <option value="XX">XX - Confirmed</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group" style="flex: 1;">
                                            <label class="form-label">Confirmed With</label>
                                            <input type="text" id="entryConfirmedWith" class="form-input" placeholder="Contact name at school">
                                        </div>
                                        <div class="form-group" style="flex: 1;">
                                            <label class="form-label">Confirmation Method</label>
                                            <select id="entryConfirmationMethod" class="form-input">
                                                <option value="">--</option>
                                                <option value="email">Email</option>
                                                <option value="phone">Phone</option>
                                                <option value="in_person">In Person</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label" style="display: flex; align-items: center; gap: 8px;">
                                            <input type="checkbox" id="entryEquipmentRental" style="width: auto; margin: 0;">
                                            <span>Equipment Rental Required (lift, scissors, etc.)</span>
                                        </label>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Notes</label>
                                        <input type="text" id="entryNotes" class="form-input" placeholder="Contact info, special instructions, etc.">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label" style="display: flex; align-items: center; gap: 6px;">
                                            Internal Notes
                                            <span style="font-size: 11px; color: #e65100; background: #fff3e0; padding: 2px 6px; border-radius: 4px; font-weight: 600;">OFFICE ONLY</span>
                                        </label>
                                        <textarea id="entryInternalNotes" class="form-input" rows="2" placeholder="Internal notes not visible to customers..." style="resize: vertical;"></textarea>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-secondary" onclick="closeAddEntryModal()">Cancel</button>
                                    <button class="btn btn-primary" onclick="saveScheduleEntry()">Add to Planning</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Office Inspections View (Field Staff items visible to office) -->
                    <div id="officeInspectionsView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Field Inspections</h1>
                            <p class="page-subtitle">View and manage all field staff inspections</p>
                        </div>

                        <button class="btn btn-primary btn-lg mb-3" onclick="startNewJob()">+ New Inspection Job</button>

                        <div class="stats-grid">
                            <div class="stat-card" style="background: #fff3e0;">
                                <div class="stat-value" style="color: #e65100;" id="officeInProgressCount">0</div>
                                <div class="stat-label">In Progress</div>
                            </div>
                            <div class="stat-card" style="background: #e8f5e9;">
                                <div class="stat-value" style="color: #2e7d32;" id="officeInspectionsCount">0</div>
                                <div class="stat-label">Submitted</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="officeTotalBanks">0</div>
                                <div class="stat-label">Banks Inspected</div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">All Inspection Jobs</h2>
                                <p style="font-size: 13px; color: #6c757d; margin-top: 4px;">Click any job to view details and generate estimate</p>
                            </div>
                            <div class="card-body" id="officeInspectionsList" style="padding: 0;"></div>
                        </div>
                    </div>

                    <!-- Office Work Orders View (Field Staff items visible to office) -->
                    <div id="officeWorkOrdersView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Work Orders</h1>
                            <p class="page-subtitle">View all field staff work orders and assignments</p>
                        </div>

                        <div class="stats-grid" style="margin-bottom: 24px;">
                            <div class="stat-card">
                                <div class="stat-value">3</div>
                                <div class="stat-label">Scheduled</div>
                            </div>
                            <div class="stat-card blue">
                                <div class="stat-value">2</div>
                                <div class="stat-label">In Progress</div>
                            </div>
                            <div class="stat-card green">
                                <div class="stat-value">8</div>
                                <div class="stat-label">Completed</div>
                            </div>
                            <div class="stat-card" style="background: #ffebee;">
                                <div class="stat-value" style="color: #c62828;">1</div>
                                <div class="stat-label" style="color: #c62828;">Pink Jobs</div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Active Work Orders</h2>
                            </div>
                            <div class="card-body" id="workOrdersList">
                                <!-- Sample Work Order 1 -->
                                <div class="inspection-item" onclick="viewWorkOrderDetail('wo1')" style="cursor: pointer;">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                        <div>
                                            <div style="margin-bottom: 8px;">
                                                <span class="part-number" style="color: #0066cc; font-size: 14px;">17208</span>
                                                <span style="margin-left: 8px; font-size: 12px; color: #6c757d;">Repair</span>
                                                <span class="badge badge-success" style="margin-left: 8px;">Parts Ready</span>
                                            </div>
                                            <strong>Ripley High School</strong>
                                            <p style="font-size: 12px; color: #6c757d; margin-top: 2px;">Lauderdale County Schools</p>
                                            <p style="font-size: 13px; margin-top: 8px;">GOAL 5: Labor to install safety strap *Lift rental required*</p>
                                            <div style="margin-top: 12px; padding: 12px; background: #f8f9fa; border-radius: 6px; font-size: 13px;">
                                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                                    <div><strong>Confirmed with:</strong></div>
                                                    <div><strong>Confirmed by:</strong></div>
                                                    <div><strong>Parts Location:</strong></div>
                                                    <div><strong>Scheduled:</strong> 1/22/2026</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div style="text-align: right;">
                                            <div style="font-size: 12px; color: #6c757d;">Assigned to</div>
                                            <div style="font-weight: 600;">TNBSTeam 2</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sample Work Order 2 -->
                                <div class="inspection-item" onclick="viewWorkOrderDetail('wo2')" style="cursor: pointer;">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                        <div>
                                            <div style="margin-bottom: 8px;">
                                                <span class="part-number" style="color: #0066cc; font-size: 14px;">17175</span>
                                                <span style="margin-left: 8px; font-size: 12px; color: #6c757d;">Service Call</span>
                                                <span class="badge badge-warning" style="margin-left: 8px;">In Progress</span>
                                            </div>
                                            <strong>Oak Mountain High School</strong>
                                            <p style="font-size: 12px; color: #6c757d; margin-top: 2px;">Shelby County Schools</p>
                                            <p style="font-size: 13px; margin-top: 8px;">Main goal winch isn't operating correctly *40' lift rental required*</p>
                                            <div style="margin-top: 12px; padding: 12px; background: #f8f9fa; border-radius: 6px; font-size: 13px;">
                                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                                    <div><strong>Confirmed with:</strong> Janet Williams</div>
                                                    <div><strong>Parts Location:</strong> On truck</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div style="text-align: right;">
                                            <div style="font-size: 12px; color: #6c757d;">Assigned to</div>
                                            <div style="font-weight: 600;">Danny Mendl</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sample Work Order 3 - Pink Job -->
                                <div class="inspection-item" style="border-left: 4px solid #e91e63; cursor: pointer;" onclick="viewWorkOrderDetail('wo3')">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                        <div>
                                            <div style="margin-bottom: 8px;">
                                                <span class="part-number" style="color: #0066cc; font-size: 14px;">17198</span>
                                                <span style="margin-left: 8px; font-size: 12px; color: #6c757d;">Service Call</span>
                                                <span class="badge badge-danger" style="margin-left: 8px;">Pink</span>
                                            </div>
                                            <strong>Harpeth High School</strong>
                                            <p style="font-size: 12px; color: #6c757d; margin-top: 2px;">Williamson County Schools</p>
                                            <p style="font-size: 13px; margin-top: 8px;">WARRANTY - Side goal not lowering - need U bolt - school provided lift</p>
                                            <div style="margin-top: 12px; padding: 12px; background: #ffebee; border-radius: 6px; font-size: 13px;">
                                                <div style="color: #c62828;"><strong>Issue:</strong> Wrong bracket ordered - need to reorder EC-457 instead of EC-450</div>
                                            </div>
                                        </div>
                                        <div style="text-align: right;">
                                            <div style="font-size: 12px; color: #6c757d;">Assigned to</div>
                                            <div style="font-weight: 600;">Lisa Cunningham</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Office Search View -->
                    <div id="officeSearchView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Search</h1>
                            <p class="page-subtitle">Find any work order, inspection, or scheduled job</p>
                        </div>

                        <div style="margin-bottom: 24px;">
                            <input type="text" id="officeSearchInput" class="form-input" placeholder="Search by school name, job #, or keyword..." style="font-size: 16px; padding: 14px 16px;" oninput="performOfficeSearch()">
                        </div>

                        <div id="officeSearchResults">
                            <div style="text-align: center; padding: 60px 20px; color: #6c757d;">
                                <div style="font-size: 48px; margin-bottom: 16px;">üîç</div>
                                <p style="font-size: 15px;">Search for a school, job number, or keyword to find work orders, inspections, and scheduled jobs.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Office Create View -->
                    <div id="officeCreateView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Create</h1>
                            <p class="page-subtitle">Start a new job</p>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Job Info</h2>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label">Job Type *</label>
                                    <select id="officeCreateTypeSelect" class="form-select" onchange="onOfficeCreateTypeChange()" style="font-size: 16px; padding: 14px;">
                                        <option value="">Select job type...</option>
                                        <option value="inspection">Inspection</option>
                                        <option value="work_order">Work Order</option>
                                        <option value="service_call">Service Call</option>
                                        <option value="go_see">Go-See</option>
                                        <option value="field_check">Field Check</option>
                                        <option value="custom">Custom</option>
                                    </select>
                                </div>

                                <!-- Custom job name field (shows right below Job Type when Custom selected) -->
                                <div id="officeCreateCustomFields" class="hidden">
                                    <div class="form-group">
                                        <label class="form-label">Custom Job Name *</label>
                                        <input type="text" id="officeCreateCustomName" class="form-input" placeholder="Enter custom job type..." style="font-size: 16px; padding: 14px;">
                                    </div>
                                </div>

                                <div id="officeCreateFormFields" class="hidden">
                                    <div class="form-group">
                                        <label class="form-label">Customer / School *</label>
                                        <div style="position: relative;">
                                            <input type="text" id="officeCreateCustomerSearch" class="form-input" placeholder="Start typing to search..." autocomplete="off" oninput="searchOfficeCreateCustomers(this.value)" style="font-size: 16px; padding: 14px;">
                                            <div id="officeCreateCustomerResults" class="customer-search-results hidden"></div>
                                            <input type="hidden" id="officeCreateCustomerId">
                                            <input type="hidden" id="officeCreateLocationId">
                                        </div>
                                    </div>
                                    <div id="officeCreateCustomerInfo" class="hidden" style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-top: 8px; margin-bottom: 16px;">
                                        <p id="officeCreateAddress" style="font-size: 13px; color: #6c757d;"></p>
                                        <p id="officeCreateContact" style="font-size: 13px; color: #6c757d; margin-top: 4px;"></p>
                                    </div>

                                    <!-- Inspection-only fields -->
                                    <div id="officeCreateInspectionFields" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">Inspection Type *</label>
                                            <select id="officeCreateInspectionType" class="form-select" style="font-size: 16px; padding: 14px;">
                                                <option value="bleacher">Indoor Bleacher Inspection</option>
                                                <option value="outdoor">Outdoor Aluminum Bleacher Inspection</option>
                                                <option value="basketball">Basketball Goal Inspection</option>
                                            </select>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Job Number</label>
                                                <input type="text" id="officeCreateJobNumber" class="form-input" readonly style="background: #e9ecef; font-weight: 700; font-size: 16px;">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Date</label>
                                                <input type="date" id="officeCreateJobDate" class="form-input" style="font-size: 16px; padding: 14px;">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Description (Work Order + Parts Spec) -->
                                    <div id="officeCreateDescriptionGroup" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">Description *</label>
                                            <textarea id="officeCreateDescription" class="form-input" rows="3" placeholder="What needs to be done..." style="font-size: 16px; padding: 14px;"></textarea>
                                        </div>
                                    </div>

                                    <!-- Notes (all types) -->
                                    <div class="form-group">
                                        <label class="form-label">Notes</label>
                                        <textarea id="officeCreateNotes" class="form-input" rows="2" placeholder="Any additional details..." style="font-size: 16px; padding: 14px;"></textarea>
                                    </div>

                                    <!-- Photo (Work Order + Parts Spec) -->
                                    <div id="officeCreatePhotoGroup" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">Photo</label>
                                            <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                                <label style="width: 80px; height: 80px; border: 2px dashed #dee2e6; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 24px; color: #adb5bd;">
                                                    üì∑
                                                    <input type="file" accept="image/*" style="display: none;" onchange="handleOfficeCreatePhoto(this)">
                                                </label>
                                                <div id="officeCreatePhotoPreview"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button id="officeCreateSubmitBtn" class="btn btn-primary btn-lg hidden" onclick="submitOfficeCreate()" style="width: 100%; margin-top: 16px; padding: 16px; font-size: 16px;">Create</button>
                    </div>

                    <!-- Employees View (Admin Only) -->
                    <div id="employeesView" class="hidden">
                        <div class="page-header">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <h1 class="page-title">Employees</h1>
                                    <p class="page-subtitle">Manage team members and roles</p>
                                </div>
                                <button class="btn btn-primary" onclick="showAddEmployeeModal()">+ Add Employee</button>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-body" style="padding: 0;">
                                <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                                    <thead>
                                        <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                                            <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #495057;">Name</th>
                                            <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #495057;">Role</th>
                                            <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #495057;">Email</th>
                                            <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #495057;">Phone</th>
                                            <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #495057;">Territory</th>
                                            <th style="padding: 12px 16px; text-align: center; font-weight: 600; color: #495057; width: 100px;">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="employeesTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Add/Edit Employee Modal -->
                    <div id="employeeModal" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 12px; padding: 32px; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto;">
                            <h2 style="margin-bottom: 24px; font-size: 20px;" id="employeeModalTitle">Add Employee</h2>
                            <div class="form-group">
                                <label class="form-label">First Name *</label>
                                <input type="text" id="empFirstName" class="form-input" placeholder="First name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Last Name *</label>
                                <input type="text" id="empLastName" class="form-input" placeholder="Last name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Role *</label>
                                <select id="empRole" class="form-select">
                                    <option value="Technician">Technician</option>
                                    <option value="Inspector">Inspector</option>
                                    <option value="Office">Office Staff</option>
                                    <option value="Admin">Admin</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" id="empEmail" class="form-input" placeholder="email@bleachers.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <input type="tel" id="empPhone" class="form-input" placeholder="(615) 555-1234">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Territory</label>
                                <select id="empTerritory" class="form-select">
                                    <option value="Original">Original (KY/TN)</option>
                                    <option value="Southern">Southern (AL/FL)</option>
                                    <option value="Both">Both</option>
                                </select>
                            </div>
                            <div style="display: flex; gap: 12px; margin-top: 24px;">
                                <button class="btn btn-primary" onclick="saveEmployee()" style="flex: 1;">Save</button>
                                <button class="btn btn-secondary" onclick="closeEmployeeModal()" style="flex: 1;">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Add/Edit Customer Modal -->
                    <div id="customerModal" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 12px; padding: 32px; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto;">
                            <h2 style="margin-bottom: 24px; font-size: 20px;" id="customerModalTitle">Add Customer</h2>
                            <div class="form-group">
                                <label class="form-label">Customer Name *</label>
                                <input type="text" id="custName" class="form-input" placeholder="e.g., Wilson County Schools">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Type *</label>
                                <select id="custType" class="form-select">
                                    <option value="county">District</option>
                                    <option value="private">Private</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Address *</label>
                                <input type="text" id="custAddress" class="form-input" placeholder="123 Main St, City, TN 12345">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Main Phone</label>
                                <input type="tel" id="custPhone" class="form-input" placeholder="(615) 555-1234">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Territory</label>
                                <select id="custTerritory" class="form-select">
                                    <option value="Original">Original (KY/TN)</option>
                                    <option value="Southern">Southern (AL/FL)</option>
                                    <option value="House">House Account</option>
                                </select>
                            </div>
                            <div style="display: flex; gap: 12px; margin-top: 24px;">
                                <button class="btn btn-primary" onclick="saveCustomer()" style="flex: 1;">Save Customer</button>
                                <button class="btn btn-secondary" onclick="closeCustomerModal()" style="flex: 1;">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Add/Edit Contact Modal -->
                    <div id="contactModal" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 12px; padding: 32px; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto;">
                            <h2 style="margin-bottom: 24px; font-size: 20px;" id="contactModalTitle">Add Contact</h2>
                            <input type="hidden" id="contactCustomerId">
                            <input type="hidden" id="contactLocationId">
                            <div class="form-group">
                                <label class="form-label">Full Name *</label>
                                <input type="text" id="contactName" class="form-input" placeholder="e.g., John Smith">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Title</label>
                                <input type="text" id="contactTitle" class="form-input" placeholder="e.g., Maintenance Director">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <input type="tel" id="contactPhone" class="form-input" placeholder="(615) 555-1234">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Mobile</label>
                                <input type="tel" id="contactMobile" class="form-input" placeholder="(615) 555-5678">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" id="contactEmail" class="form-input" placeholder="john@example.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Roles (select all that apply)</label>
                                <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                                    <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: #f8f9fa; border-radius: 6px; cursor: pointer;">
                                        <input type="checkbox" id="roleScheduling" value="scheduling"> üìÖ Scheduling
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: #f8f9fa; border-radius: 6px; cursor: pointer;">
                                        <input type="checkbox" id="roleContracts" value="contracts"> üìù Contracts
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: #f8f9fa; border-radius: 6px; cursor: pointer;">
                                        <input type="checkbox" id="roleBilling" value="billing"> üí∞ Billing
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: #f8f9fa; border-radius: 6px; cursor: pointer;">
                                        <input type="checkbox" id="roleEquipment" value="equipment"> üîß Equipment
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: #f8f9fa; border-radius: 6px; cursor: pointer;">
                                        <input type="checkbox" id="roleAccess" value="access"> üîë Access
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: #f8f9fa; border-radius: 6px; cursor: pointer;">
                                        <input type="checkbox" id="rolePrimary" value="primary"> üìû Primary
                                    </label>
                                </div>
                            </div>
                            <div style="display: flex; gap: 12px; margin-top: 24px;">
                                <button class="btn btn-primary" onclick="saveContact()" style="flex: 1;">Save Contact</button>
                                <button class="btn btn-secondary" onclick="closeContactModal()" style="flex: 1;">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Add/Edit Location Modal -->
                    <div id="locationModal" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 12px; padding: 32px; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto;">
                            <h2 style="margin-bottom: 24px; font-size: 20px;" id="locationModalTitle">Add Location</h2>
                            <input type="hidden" id="locationCustomerId">
                            <div class="form-group">
                                <label class="form-label">Location Name *</label>
                                <input type="text" id="locationName" class="form-input" placeholder="e.g., Central High School">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Address *</label>
                                <input type="text" id="locationAddress" class="form-input" placeholder="123 School St, City, TN 12345">
                            </div>
                            <div style="display: flex; gap: 12px; margin-top: 24px;">
                                <button class="btn btn-primary" onclick="saveLocation()" style="flex: 1;">Save Location</button>
                                <button class="btn btn-secondary" onclick="closeLocationModal()" style="flex: 1;">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Settings View (Admin Only) -->
                    <div id="settingsView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Settings</h1>
                            <p class="page-subtitle">Profile, integrations, and data management</p>
                        </div>

                        <!-- Profile Section (Everyone) -->
                        <div class="card" style="margin-bottom: 24px;">
                            <div class="card-header">
                                <h2 class="card-title">Profile</h2>
                            </div>
                            <div class="card-body">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label class="form-label">Name</label>
                                        <input type="text" id="settingsUserName" class="form-input" placeholder="Your name">
                                    </div>
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label class="form-label">Phone</label>
                                        <input type="tel" id="settingsUserPhone" class="form-input" placeholder="(555) 123-4567">
                                    </div>
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label class="form-label">Email</label>
                                        <input type="email" id="settingsUserEmail" class="form-input" placeholder="you@example.com">
                                    </div>
                                </div>
                                <div style="margin-top: 16px;">
                                    <button class="btn btn-primary" onclick="saveUserProfile()">Save Profile</button>
                                </div>
                            </div>
                        </div>

                        <!-- QuickBooks Section (Office + Admin) -->
                        <div id="settingsQBSection" class="card hidden" style="margin-bottom: 24px;">
                            <div class="card-header">
                                <h2 class="card-title">QuickBooks Integration</h2>
                            </div>
                            <div class="card-body">
                                <div style="display: flex; align-items: center; gap: 16px;">
                                    <div id="qbStatusIndicator" style="width: 12px; height: 12px; border-radius: 50%; background: #9e9e9e;"></div>
                                    <div style="flex: 1;">
                                        <p style="font-weight: 600; margin-bottom: 2px;" id="qbStatusText">Checking connection...</p>
                                        <p style="font-size: 13px; color: #6c757d;" id="qbStatusDetail">Verifying QuickBooks Online connection status</p>
                                    </div>
                                    <button class="btn btn-outline" id="qbReconnectBtn" onclick="reconnectQuickBooks()" style="display: none;">Reconnect</button>
                                </div>
                            </div>
                        </div>

                        <!-- Manage Section (Admin Only) -->
                        <div id="settingsDataSection" class="hidden">
                            <div class="card">
                                <div class="card-header" style="border-bottom: none; padding-bottom: 0;">
                                    <h2 class="card-title">Manage</h2>
                                </div>
                                <div class="card-body" style="padding-top: 12px;">
                                    <!-- Tabs -->
                                    <div style="display: flex; gap: 0; margin-bottom: 24px; border-bottom: 2px solid #dee2e6;">
                                        <button class="btn" id="dmTabEmployees" onclick="switchDataTab('employees')" style="border: none; border-bottom: 3px solid #4f46e5; border-radius: 0; padding: 12px 24px; font-weight: 600; color: #4f46e5;">Employees</button>
                                        <button class="btn" id="dmTabParts" onclick="switchDataTab('parts')" style="border: none; border-bottom: 3px solid transparent; border-radius: 0; padding: 12px 24px; font-weight: 600; color: #6c757d;">Parts Catalog</button>
                                        <button class="btn" id="dmTabImport" onclick="switchDataTab('import')" style="border: none; border-bottom: 3px solid transparent; border-radius: 0; padding: 12px 24px; font-weight: 600; color: #6c757d;">Import Pricing</button>
                                        <button class="btn" id="dmTabVendors" onclick="switchDataTab('vendors')" style="border: none; border-bottom: 3px solid transparent; border-radius: 0; padding: 12px 24px; font-weight: 600; color: #6c757d;">Vendors</button>
                                        <button class="btn" id="dmTabBulletins" onclick="switchDataTab('bulletins')" style="border: none; border-bottom: 3px solid transparent; border-radius: 0; padding: 12px 24px; font-weight: 600; color: #6c757d;">Bulletins</button>
                                        <button class="btn" id="dmTabImages" onclick="switchDataTab('images')" style="border: none; border-bottom: 3px solid transparent; border-radius: 0; padding: 12px 24px; font-weight: 600; color: #6c757d;">Bulk Images</button>
                                    </div>

                                    <!-- Employees Tab -->
                                    <div id="dmEmployeesTab">
                                        <div style="display: flex; justify-content: flex-end; margin-bottom: 16px;">
                                            <button class="btn btn-primary" onclick="showAddEmployeeModal()">+ Add Employee</button>
                                        </div>
                                        <div id="employeesListManage"></div>
                                    </div>

                        <!-- Parts Catalog Tab -->
                        <div id="dmPartsTab" class="hidden">
                            <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                                <input type="text" id="dmPartsSearch" class="form-input" placeholder="Search parts by name, number, or category..." oninput="filterAdminParts()" style="flex: 1;">
                                <select id="dmPartsCategoryFilter" class="form-select" onchange="filterAdminParts()" style="width: 200px;">
                                    <option value="">All Categories</option>
                                </select>
                                <button class="btn btn-primary" onclick="showAddPartModal()">+ Add Part</button>
                            </div>
                            <div class="card">
                                <div class="card-body" style="padding: 0;">
                                    <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                                        <thead>
                                            <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                                                <th style="padding: 10px 12px; text-align: left; font-weight: 600; color: #495057;">Part #</th>
                                                <th style="padding: 10px 12px; text-align: left; font-weight: 600; color: #495057;">Name</th>
                                                <th style="padding: 10px 12px; text-align: left; font-weight: 600; color: #495057;">Category</th>
                                                <th style="padding: 10px 12px; text-align: left; font-weight: 600; color: #495057;">Vendor</th>
                                                <th style="padding: 10px 12px; text-align: right; font-weight: 600; color: #495057;">Price</th>
                                                <th style="padding: 10px 12px; text-align: center; font-weight: 600; color: #495057; width: 100px;">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="dmPartsTableBody"></tbody>
                                    </table>
                                    <div id="dmPartsCount" style="padding: 12px 16px; font-size: 13px; color: #6c757d; border-top: 1px solid #dee2e6;"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Import Pricing Tab -->
                        <div id="dmImportTab" class="hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Import Vendor Pricing CSV</h2>
                                </div>
                                <div class="card-body">
                                    <p style="color: #6c757d; margin-bottom: 16px;">Upload a CSV file from a vendor to update pricing. The CSV should include columns for Part Number and Price at minimum.</p>
                                    <div class="form-group">
                                        <label class="form-label">Vendor</label>
                                        <select id="importVendor" class="form-select">
                                            <option value="">Select vendor...</option>
                                            <option value="Hussey">Hussey Seating Co</option>
                                            <option value="Draper">Draper</option>
                                            <option value="Interkal">Interkal</option>
                                            <option value="Porter">Porter</option>
                                            <option value="Jaypro">Jaypro</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Effective Date</label>
                                        <input type="date" id="importEffectiveDate" class="form-input">
                                    </div>
                                    <div id="csvDropZone" style="border: 2px dashed #dee2e6; border-radius: 12px; padding: 48px; text-align: center; cursor: pointer; margin-bottom: 16px; transition: border-color 0.2s;" onclick="document.getElementById('csvFileInput').click();" ondragover="event.preventDefault(); this.style.borderColor='#4f46e5';" ondragleave="this.style.borderColor='#dee2e6';" ondrop="event.preventDefault(); this.style.borderColor='#dee2e6'; handleCsvDrop(event);">
                                        <div style="font-size: 48px; margin-bottom: 12px;">üìÑ</div>
                                        <p style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Drop CSV file here or click to browse</p>
                                        <p style="font-size: 13px; color: #6c757d;">Supports .csv files</p>
                                        <input type="file" id="csvFileInput" accept=".csv" style="display: none;" onchange="handleCsvFile(this.files[0])">
                                    </div>
                                    <div id="csvPreview" class="hidden">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                            <h3 style="font-size: 16px; font-weight: 600;">Preview Changes</h3>
                                            <span id="csvPreviewCount" style="font-size: 13px; color: #6c757d;"></span>
                                        </div>
                                        <div style="max-height: 400px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 8px;">
                                            <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                                                <thead>
                                                    <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6; position: sticky; top: 0;">
                                                        <th style="padding: 10px 12px; text-align: left;">Part #</th>
                                                        <th style="padding: 10px 12px; text-align: left;">Name</th>
                                                        <th style="padding: 10px 12px; text-align: right;">Current Price</th>
                                                        <th style="padding: 10px 12px; text-align: right;">New Price</th>
                                                        <th style="padding: 10px 12px; text-align: right;">Change</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="csvPreviewBody"></tbody>
                                            </table>
                                        </div>
                                        <div style="display: flex; gap: 12px; margin-top: 16px;">
                                            <button class="btn btn-primary" onclick="applyCsvImport()">Apply Price Updates</button>
                                            <button class="btn btn-secondary" onclick="cancelCsvImport()">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Import History -->
                            <div class="card" style="margin-top: 24px;">
                                <div class="card-header">
                                    <h2 class="card-title">Import History</h2>
                                </div>
                                <div class="card-body" style="padding: 0;">
                                    <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                                        <thead>
                                            <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                                                <th style="padding: 10px 12px; text-align: left;">Date</th>
                                                <th style="padding: 10px 12px; text-align: left;">Vendor</th>
                                                <th style="padding: 10px 12px; text-align: left;">File</th>
                                                <th style="padding: 10px 12px; text-align: right;">Parts Updated</th>
                                                <th style="padding: 10px 12px; text-align: left;">Imported By</th>
                                            </tr>
                                        </thead>
                                        <tbody id="importHistoryBody">
                                            <tr style="border-bottom: 1px solid #f0f2f5;">
                                                <td style="padding: 10px 12px;">Jan 28, 2026</td>
                                                <td style="padding: 10px 12px;">Hussey</td>
                                                <td style="padding: 10px 12px;">2025 Price Guide For BS.csv</td>
                                                <td style="padding: 10px 12px; text-align: right;">2,142</td>
                                                <td style="padding: 10px 12px;">Christian</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                                    <!-- Vendors Tab -->
                                    <div id="dmVendorsTab" class="hidden">
                                        <div style="display: flex; justify-content: flex-end; margin-bottom: 16px;">
                                            <button class="btn btn-primary" onclick="showAddVendorModal()">+ Add Vendor</button>
                                        </div>
                                        <div id="vendorsList"></div>
                                    </div>

                                    <!-- Bulletins Tab -->
                                    <div id="dmBulletinsTab" class="hidden">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                            <p style="color: #6c757d; margin: 0;">Company-wide announcements shown on the Home page for all users.</p>
                                            <button class="btn btn-primary" onclick="showAddBulletinModal()">+ Add Bulletin</button>
                                        </div>
                                        <div id="bulletinsList"></div>
                                    </div>

                                    <!-- Bulk Images Tab -->
                                    <div id="dmImagesTab" class="hidden">
                                        <div class="card">
                                            <div class="card-header">
                                                <h2 class="card-title" style="font-size: 18px; font-weight: 700;">Bulk Image Upload</h2>
                                                <p style="color: #6c757d; font-size: 13px; margin-top: 4px;">
                                                    Upload a folder of images. Filenames should match part numbers (e.g., 302-1000.jpg)
                                                </p>
                                            </div>
                                            <div class="card-body">
                                                <div id="bulkImageDropZone" style="border: 2px dashed #dee2e6; border-radius: 12px; padding: 48px; text-align: center; cursor: pointer;"
                                                     onclick="document.getElementById('bulkImageInput').click();"
                                                     ondragover="event.preventDefault(); this.style.borderColor='#4f46e5';"
                                                     ondragleave="this.style.borderColor='#dee2e6';">
                                                    <div style="font-size: 48px; margin-bottom: 12px;">üìÅ</div>
                                                    <p style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Drop images here or click to browse</p>
                                                    <p style="font-size: 13px; color: #6c757d;">Supports .jpg, .png, .webp</p>
                                                    <input type="file" id="bulkImageInput" multiple accept="image/*"
                                                           style="display: none;" onchange="handleBulkImageSelect(this)">
                                                </div>

                                                <div id="bulkImagePreview" class="hidden" style="margin-top: 24px;">
                                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                                        <span id="bulkImageCount" style="font-weight: 600;"></span>
                                                        <button class="btn btn-primary" onclick="uploadBulkImages()">Upload All</button>
                                                    </div>
                                                    <div id="bulkImageList" style="max-height: 300px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 8px;"></div>
                                                </div>

                                                <div id="bulkImageResults" class="hidden" style="margin-top: 24px;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Add/Edit Part Modal -->
                    <div id="partModal" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 12px; padding: 32px; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto;">
                            <h2 style="margin-bottom: 24px; font-size: 20px;" id="partModalTitle">Add Part</h2>
                            <div class="form-group">
                                <label class="form-label">Part Number</label>
                                <input type="text" id="partNumInput" class="form-input" placeholder="e.g. HUS-12345">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Name / Description *</label>
                                <input type="text" id="partNameInput" class="form-input" placeholder="Part name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Category</label>
                                <select id="partCategoryInput" class="form-select">
                                    <option value="">Select...</option>
                                    <option value="Power & Electrical">Power & Electrical</option>
                                    <option value="Hardware">Hardware</option>
                                    <option value="Frames & Supports">Frames & Supports</option>
                                    <option value="Rails & Steps">Rails & Steps</option>
                                    <option value="Seating">Seating</option>
                                    <option value="Rollout Parts">Rollout Parts</option>
                                    <option value="Stanchions">Stanchions</option>
                                    <option value="Lumber & Decking">Lumber & Decking</option>
                                    <option value="Portable & Skids">Portable & Skids</option>
                                    <option value="Flex Row Parts">Flex Row Parts</option>
                                    <option value="Panels & Closures">Panels & Closures</option>
                                    <option value="Controls & Safety">Controls & Safety</option>
                                    <option value="Wheels & Bearings">Wheels & Bearings</option>
                                    <option value="Tools">Tools</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Vendor *</label>
                                <select id="partVendorInput" class="form-select">
                                    <option value="Hussey">Hussey</option>
                                    <option value="Draper">Draper</option>
                                    <option value="Interkal">Interkal</option>
                                    <option value="Porter">Porter</option>
                                    <option value="Jaypro">Jaypro</option>
                                    <option value="Irwin">Irwin</option>
                                    <option value="Kodiak">Kodiak</option>
                                    <option value="Duckbill">Duckbill</option>
                                    <option value="APDC">APDC</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Price ($)</label>
                                <input type="number" id="partPriceInput" class="form-input" placeholder="0.00" step="0.01">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Part Image</label>
                                <div id="partImagePreview" style="margin-bottom: 8px;"></div>
                                <div id="partImagePasteZone" tabindex="0" style="border: 2px dashed #ddd; border-radius: 8px; padding: 16px; text-align: center; cursor: pointer; margin-bottom: 8px; transition: all 0.2s;" onclick="document.getElementById('partImageInput').click()" onpaste="handlePartImagePaste(event)">
                                    <div style="color: #6c757d; font-size: 13px;">üìã Paste screenshot here (Ctrl/Cmd+V)</div>
                                    <div style="color: #999; font-size: 11px; margin-top: 4px;">or click to browse files</div>
                                </div>
                                <input type="file" id="partImageInput" accept="image/*" onchange="handlePartImageUpload(this)" style="display: none;">
                            </div>
                            <div style="display: flex; gap: 12px; margin-top: 24px;">
                                <button class="btn btn-primary" onclick="savePart()" style="flex: 1;">Save</button>
                                <button class="btn btn-secondary" onclick="closePartModal()" style="flex: 1;">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Add Vendor Modal -->
                    <div id="vendorModal" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 12px; padding: 32px; width: 100%; max-width: 500px;">
                            <h2 style="margin-bottom: 24px; font-size: 20px;" id="vendorModalTitle">Add Vendor</h2>
                            <div class="form-group">
                                <label class="form-label">Vendor Name *</label>
                                <input type="text" id="vendorNameInput" class="form-input" placeholder="e.g. Hussey Seating Co">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Contact Name</label>
                                <input type="text" id="vendorContactInput" class="form-input" placeholder="Sales rep name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <input type="tel" id="vendorPhoneInput" class="form-input" placeholder="(555) 555-1234">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" id="vendorEmailInput" class="form-input" placeholder="vendor@company.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Tier</label>
                                <select id="vendorTierInput" class="form-select">
                                    <option value="1">Tier 1 - Primary Partner</option>
                                    <option value="2">Tier 2 - Secondary</option>
                                    <option value="3">Tier 3 - Occasional/Specialty</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Notes</label>
                                <textarea id="vendorNotesInput" class="form-input" rows="2" placeholder="Territory, specialties, etc."></textarea>
                            </div>
                            <div style="display: flex; gap: 12px; margin-top: 24px;">
                                <button class="btn btn-primary" onclick="saveVendor()" style="flex: 1;">Save</button>
                                <button class="btn btn-secondary" onclick="closeVendorModal()" style="flex: 1;">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Add/Edit Bulletin Modal -->
                    <div id="bulletinModal" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 12px; padding: 32px; width: 100%; max-width: 500px;">
                            <h2 style="margin-bottom: 24px; font-size: 20px;" id="bulletinModalTitle">Add Bulletin</h2>
                            <div class="form-group">
                                <label class="form-label">Type *</label>
                                <select id="bulletinTypeInput" class="form-select">
                                    <option value="info">Info - General information</option>
                                    <option value="alert">Alert - Important notice</option>
                                    <option value="holiday">Holiday - Office closures</option>
                                    <option value="safety">Safety - Safety reminders</option>
                                    <option value="hr">HR - HR announcements</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Title *</label>
                                <input type="text" id="bulletinTitleInput" class="form-input" placeholder="e.g. Office Closed Monday">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Message *</label>
                                <textarea id="bulletinMessageInput" class="form-input" rows="3" placeholder="The full announcement message..."></textarea>
                            </div>
                            <div class="form-group">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                    <input type="checkbox" id="bulletinActiveInput" checked style="width: 18px; height: 18px;">
                                    <span>Active (visible on Home page)</span>
                                </label>
                            </div>
                            <div style="display: flex; gap: 12px; margin-top: 24px;">
                                <button class="btn btn-primary" onclick="saveBulletin()" style="flex: 1;">Save</button>
                                <button class="btn btn-secondary" onclick="closeBulletinModal()" style="flex: 1;">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Work Order Detail View (Office Staff - Read-only with Edit buttons) -->
                    <div id="workOrderDetailView" class="hidden">
                        <div class="page-header">
                            <button class="btn btn-secondary" onclick="goBackFromWorkOrder()">‚Üê Back</button>
                            <div style="display: flex; align-items: center; gap: 12px; margin-top: 16px;">
                                <h1 class="page-title" style="margin: 0;" id="woJobNumber">Job #17208</h1>
                                <span id="woJobTypeBadge" class="badge badge-info">Repair</span>
                                <span id="woStatusBadge" class="badge badge-success">Parts Received</span>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 300px; gap: 24px;">
                            <!-- Main Column -->
                            <div>
                                <!-- Job Info Card (Read-Only - matches Field Staff layout) -->
                                <div class="card" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
                                    <div class="card-body">
                                        <!-- Location Section -->
                                        <div id="woLocationSection" style="margin-bottom: 20px;">
                                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                                <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px; text-transform: uppercase; font-weight: 600;">Location</p>
                                                <button class="btn btn-sm" onclick="toggleEditSection('location')" style="padding: 4px 12px; font-size: 12px;" id="woLocationEditBtn">Edit</button>
                                            </div>
                                            <!-- Read-only view -->
                                            <div id="woLocationDisplay">
                                                <h2 id="woLocationName" style="font-size: 20px; font-weight: 700; margin-bottom: 4px;">Ripley High School</h2>
                                                <p id="woLocationAddress" style="font-size: 14px; color: #495057;">254 S Jefferson St, Ripley, TN 38063</p>
                                                <a id="woDirectionsLink" href="https://maps.google.com/?q=254+S+Jefferson+St+Ripley+TN+38063" target="_blank"
                                                   style="display: inline-flex; align-items: center; gap: 6px; margin-top: 8px; color: #0066cc; font-weight: 600; text-decoration: none;">
                                                    üó∫Ô∏è Get Directions
                                                </a>
                                            </div>
                                            <!-- Edit view -->
                                            <div id="woLocationEdit" class="hidden" style="margin-top: 8px;">
                                                <select id="woCustomerLocation" class="form-select" style="font-size: 16px; font-weight: 600; margin-bottom: 8px;" onchange="updateOfficeWorkOrderLocation()">
                                                    <option value="">Select customer & location...</option>
                                                </select>
                                                <input type="text" id="woLocationAddressInput" class="form-input" placeholder="Address" style="margin-top: 8px;">
                                                <div style="margin-top: 12px;">
                                                    <button class="btn btn-primary btn-sm" onclick="saveSection('location')" style="margin-right: 8px;">Save</button>
                                                    <button class="btn btn-secondary btn-sm" onclick="cancelEditSection('location')">Cancel</button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Site Contact Section -->
                                        <div id="woContactSection" style="margin-bottom: 20px; padding: 12px; background: white; border-radius: 8px;">
                                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                                <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px; text-transform: uppercase; font-weight: 600;">Site Contact</p>
                                                <button class="btn btn-sm" onclick="toggleEditSection('contact')" style="padding: 4px 12px; font-size: 12px;" id="woContactEditBtn">Edit</button>
                                            </div>
                                            <!-- Read-only view -->
                                            <div id="woContactDisplay">
                                                <p id="woContactName" style="font-size: 16px; font-weight: 600; margin-bottom: 4px;"></p>
                                                <a id="woContactPhoneLink" href="tel:" style="color: #0066cc; font-weight: 600; text-decoration: none;">üìû <span id="woContactPhone"></span></a>
                                            </div>
                                            <!-- Edit view -->
                                            <div id="woContactEdit" class="hidden" style="margin-top: 8px;">
                                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                                    <input type="text" id="woContactNameInput" class="form-input" placeholder="Contact name">
                                                    <input type="tel" id="woContactPhoneInput" class="form-input" placeholder="Phone number">
                                                </div>
                                                <div style="margin-top: 12px;">
                                                    <button class="btn btn-primary btn-sm" onclick="saveSection('contact')" style="margin-right: 8px;">Save</button>
                                                    <button class="btn btn-secondary btn-sm" onclick="cancelEditSection('contact')">Cancel</button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Job Description Section -->
                                        <div id="woDescriptionSection" style="margin-bottom: 20px; padding: 16px; background: white; border-radius: 8px; border-left: 4px solid #4CAF50;">
                                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                                <p style="font-size: 12px; color: #6c757d; margin-bottom: 8px; text-transform: uppercase; font-weight: 600;">What They're Doing</p>
                                                <button class="btn btn-sm" onclick="toggleEditSection('description')" style="padding: 4px 12px; font-size: 12px;" id="woDescriptionEditBtn">Edit</button>
                                            </div>
                                            <!-- Read-only view -->
                                            <div id="woDescriptionDisplay">
                                                <p id="woDescription" style="font-size: 16px; line-height: 1.5;">Install safety strap on Goal 5. Lift rental required - 40' lift will be on site.</p>
                                            </div>
                                            <!-- Edit view -->
                                            <div id="woDescriptionEdit" class="hidden">
                                                <textarea id="woDescriptionInput" class="form-input" rows="3" style="font-size: 16px; line-height: 1.5;" placeholder="Job description..."></textarea>
                                                <div style="margin-top: 12px;">
                                                    <button class="btn btn-primary btn-sm" onclick="saveSection('description')" style="margin-right: 8px;">Save</button>
                                                    <button class="btn btn-secondary btn-sm" onclick="cancelEditSection('description')">Cancel</button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Parts Location Section -->
                                        <div id="woPartsSection" style="padding: 12px; background: #fff3e0; border-radius: 8px; border-left: 4px solid #ff9800;">
                                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                                <p style="font-size: 12px; color: #e65100; margin-bottom: 4px; text-transform: uppercase; font-weight: 600;">üì¶ Parts Location</p>
                                                <button class="btn btn-sm" onclick="toggleEditSection('parts')" style="padding: 4px 12px; font-size: 12px;" id="woPartsEditBtn">Edit</button>
                                            </div>
                                            <!-- Read-only view -->
                                            <div id="woPartsDisplay">
                                                <p id="woPartsLocation" style="font-size: 14px; font-weight: 600; color: #e65100;"></p>
                                            </div>
                                            <!-- Edit view -->
                                            <div id="woPartsEdit" class="hidden">
                                                <input type="text" id="woPartsLocationInput" class="form-input" placeholder="Where are the parts?" style="background: white;">
                                                <div style="margin-top: 12px;">
                                                    <button class="btn btn-primary btn-sm" onclick="saveSection('parts')" style="margin-right: 8px;">Save</button>
                                                    <button class="btn btn-secondary btn-sm" onclick="cancelEditSection('parts')">Cancel</button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Special Instructions Section -->
                                        <div id="woInstructionsSection" style="margin-top: 16px; padding: 12px; background: #e3f2fd; border-radius: 8px; border-left: 4px solid #2196F3;">
                                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                                <p style="font-size: 12px; color: #1565c0; margin-bottom: 4px; text-transform: uppercase; font-weight: 600;">‚ö†Ô∏è Special Instructions</p>
                                                <button class="btn btn-sm" onclick="toggleEditSection('instructions')" style="padding: 4px 12px; font-size: 12px;" id="woInstructionsEditBtn">Edit</button>
                                            </div>
                                            <!-- Read-only view -->
                                            <div id="woInstructionsDisplay">
                                                <p id="woSpecialInstructions" style="font-size: 14px; color: #1565c0;">Customer will have gym cleared by 8am. Enter through back door - front office doesn't open until 9.</p>
                                            </div>
                                            <!-- Edit view -->
                                            <div id="woInstructionsEdit" class="hidden">
                                                <textarea id="woSpecialInstructionsInput" class="form-input" rows="2" placeholder="Equipment needs, access instructions, etc." style="background: white;"></textarea>
                                                <div style="margin-top: 12px;">
                                                    <button class="btn btn-primary btn-sm" onclick="saveSection('instructions')" style="margin-right: 8px;">Save</button>
                                                    <button class="btn btn-secondary btn-sm" onclick="cancelEditSection('instructions')">Cancel</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Scheduling & Assignment Card -->
                                <div class="card">
                                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                                        <h2 class="card-title" style="margin: 0;">Scheduling & Assignment</h2>
                                        <button class="btn btn-sm" onclick="toggleEditSection('scheduling')" style="padding: 4px 12px; font-size: 12px;" id="woSchedulingEditBtn">Edit</button>
                                    </div>
                                    <div class="card-body">
                                        <!-- Read-only view -->
                                        <div id="woSchedulingDisplay">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;">
                                                <div>
                                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">Scheduled Date</p>
                                                    <p id="woScheduledDateDisplay" style="font-weight: 600;">Jan 22, 2026</p>
                                                </div>
                                                <div>
                                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">Scheduled Time</p>
                                                    <p id="woScheduledTimeDisplay" style="font-weight: 600;">8:00 AM</p>
                                                </div>
                                                <div>
                                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">Assigned To</p>
                                                    <p id="woAssignedToDisplay" style="font-weight: 600;">TNBSTeam 2</p>
                                                </div>
                                            </div>
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-top: 16px;">
                                                <div>
                                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">Confirmed With</p>
                                                    <p id="woConfirmedWithDisplay" style="font-weight: 600;"></p>
                                                </div>
                                                <div>
                                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">Confirmed By</p>
                                                    <p id="woConfirmedByDisplay" style="font-weight: 600;"></p>
                                                </div>
                                                <div>
                                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">Confirmation Date</p>
                                                    <p id="woConfirmedDateDisplay" style="font-weight: 600;">Jan 23, 2026</p>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Edit view -->
                                        <div id="woSchedulingEdit" class="hidden">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;">
                                                <div class="form-group">
                                                    <label class="form-label">Scheduled Date</label>
                                                    <input type="date" id="woScheduledDate" class="form-input" value="2026-01-22">
                                                </div>
                                                <div class="form-group">
                                                    <label class="form-label">Scheduled Time</label>
                                                    <input type="time" id="woScheduledTime" class="form-input" value="08:00">
                                                </div>
                                                <div class="form-group">
                                                    <label class="form-label">Assigned To</label>
                                                    <select id="woAssignedTo" class="form-select">
                                                        <option value="">Select tech/team</option>
                                                        <option value="TNBSTeam 1">TNBSTeam 1</option>
                                                        <option value="TNBSTeam 2" selected>TNBSTeam 2</option>
                                                        <option value="ALBSTeam 1">ALBSTeam 1</option>
                                                        <option value="ALBSTeam 2">ALBSTeam 2</option>
                                                        <option value="Danny Mendl">Danny Mendl</option>
                                                        <option value="Floyd Jackson">Floyd Jackson</option>
                                                        <option value="Lisa Cunningham">Lisa Cunningham</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-top: 16px;">
                                                <div class="form-group">
                                                    <label class="form-label">Confirmed With</label>
                                                    <input type="text" id="woConfirmedWith" class="form-input" placeholder="Customer contact">
                                                </div>
                                                <div class="form-group">
                                                    <label class="form-label">Confirmed By</label>
                                                    <input type="text" id="woConfirmedBy" class="form-input" placeholder="Office staff">
                                                </div>
                                                <div class="form-group">
                                                    <label class="form-label">Confirmation Date</label>
                                                    <input type="date" id="woConfirmedDate" class="form-input">
                                                </div>
                                            </div>
                                            <div style="margin-top: 16px;">
                                                <button class="btn btn-primary btn-sm" onclick="saveSection('scheduling')" style="margin-right: 8px;">Save</button>
                                                <button class="btn btn-secondary btn-sm" onclick="cancelEditSection('scheduling')">Cancel</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Completion Summary Card (Office View) -->
                                <div class="card">
                                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                                        <h2 class="card-title" style="margin: 0;">Completion Summary</h2>
                                        <button class="btn btn-sm" onclick="toggleEditSection('completionSummary')" style="padding: 4px 12px; font-size: 12px;" id="woCompletionSummaryEditBtn">Edit</button>
                                    </div>
                                    <div class="card-body">
                                        <!-- Read-only view -->
                                        <div id="woCompletionSummaryDisplay">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;">
                                                <div>
                                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">Job Status</p>
                                                    <p id="woCompletedDisplay" style="font-weight: 600;">‚Äî</p>
                                                </div>
                                                <div>
                                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">Hours Worked</p>
                                                    <p id="woHoursWorkedDisplay" style="font-weight: 600;">‚Äî</p>
                                                </div>
                                                <div>
                                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">Completed By</p>
                                                    <p id="woCompletedByDisplay" style="font-weight: 600;">‚Äî</p>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Edit view -->
                                        <div id="woCompletionSummaryEdit" class="hidden">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;">
                                                <div class="form-group">
                                                    <label class="form-label">Job Status</label>
                                                    <select id="woCompleted" class="form-select">
                                                        <option value="">Select...</option>
                                                        <option value="yes">Completed</option>
                                                        <option value="no">Not Completed (Pink Job)</option>
                                                    </select>
                                                </div>
                                                <div class="form-group">
                                                    <label class="form-label">Hours Worked</label>
                                                    <input type="number" id="woHoursWorked" class="form-input" step="0.5" placeholder="e.g., 4.5">
                                                </div>
                                                <div class="form-group">
                                                    <label class="form-label">Completed By</label>
                                                    <input type="text" id="woCompletedBy" class="form-input" placeholder="Tech name(s)">
                                                </div>
                                            </div>
                                            <div style="margin-top: 16px;">
                                                <button class="btn btn-primary btn-sm" onclick="saveSection('completionSummary')" style="margin-right: 8px;">Save</button>
                                                <button class="btn btn-secondary btn-sm" onclick="cancelEditSection('completionSummary')">Cancel</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Completion Photos Card (Matches Field Staff) -->
                                <div class="card">
                                    <div class="card-header" style="background: #4CAF50; color: white;">
                                        <h2 class="card-title" style="color: white; margin: 0;">üì∑ Completion Photos & Notes</h2>
                                    </div>
                                    <div class="card-body">
                                        <!-- Required Photo Upload -->
                                        <div class="form-group">
                                            <label class="form-label" style="font-weight: 700;">
                                                üì∑ Completed Work Photo <span style="color: #dc3545;">*Required</span>
                                            </label>
                                            <p style="font-size: 13px; color: #6c757d; margin-bottom: 12px;">Photo showing the completed work</p>
                                            <div id="woPhotoUploadArea" style="border: 2px dashed #dee2e6; border-radius: 8px; padding: 40px; text-align: center; cursor: pointer; background: #f8f9fa;"
                                                 onclick="document.getElementById('woPhotoInput').click()">
                                                <div style="font-size: 48px; margin-bottom: 12px;">üì∑</div>
                                                <p style="font-weight: 600; color: #495057;">Click to upload photo</p>
                                                <input type="file" id="woPhotoInput" accept="image/*" style="display: none;" onchange="handleOfficePhotoUpload(event, 'main')">
                                            </div>
                                            <div id="woPhotoPreview" class="hidden" style="margin-top: 12px;"></div>
                                        </div>

                                        <!-- Additional Photos -->
                                        <div class="form-group" style="margin-top: 20px;">
                                            <label class="form-label">üì∑ Additional Photos (Optional)</label>
                                            <p style="font-size: 13px; color: #6c757d; margin-bottom: 12px;">Add more photos if needed (issues found, before/after, etc.)</p>
                                            <div style="border: 2px dashed #dee2e6; border-radius: 8px; padding: 20px; text-align: center; cursor: pointer; background: #f8f9fa;"
                                                 onclick="document.getElementById('woAdditionalPhotos').click()">
                                                <p style="color: #6c757d;">+ Add more photos</p>
                                                <input type="file" id="woAdditionalPhotos" accept="image/*" multiple style="display: none;" onchange="handleOfficePhotoUpload(event, 'additional')">
                                            </div>
                                            <div id="woAdditionalPhotosPreview" style="display: flex; flex-wrap: wrap; gap: 12px; margin-top: 12px;"></div>
                                        </div>

                                        <!-- Required Notes -->
                                        <div class="form-group" style="margin-top: 20px;">
                                            <label class="form-label" style="font-weight: 700;">
                                                üìù Completion Notes <span style="color: #dc3545;">*Required</span>
                                            </label>
                                            <p style="font-size: 13px; color: #6c757d; margin-bottom: 12px;">Describe work completed</p>
                                            <textarea id="woCompletionNotes" class="form-input" rows="4"
                                                      placeholder="Example: Installed safety strap on Goal 5. Tested operation - working properly. No additional issues found."
                                                      style="font-size: 16px;"></textarea>
                                        </div>

                                        <!-- Action Buttons -->
                                        <div style="margin-top: 24px;">
                                            <button class="btn btn-primary btn-lg" onclick="submitOfficeJobCompleted()"
                                                    style="width: 100%; padding: 16px; font-size: 16px; background: #4CAF50; border-color: #4CAF50;">
                                                ‚úÖ Mark Job Completed
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Not Completed Section (Matches Field Staff) -->
                                <div class="card">
                                    <div class="card-header" style="background: #dc3545; color: white;">
                                        <h2 class="card-title" style="color: white; margin: 0;">‚ùå Job Not Completed</h2>
                                    </div>
                                    <div class="card-body">
                                        <p style="font-size: 14px; color: #6c757d; margin-bottom: 16px;">If the job couldn't be completed, document what happened:</p>

                                        <!-- Reason Buttons -->
                                        <div id="woReasonButtons" style="display: flex; flex-direction: column; gap: 10px;">
                                            <button type="button" onclick="selectOfficeNotCompletedReason('wrong_part')" class="reason-btn"
                                                    style="padding: 16px 20px; border: 2px solid #dee2e6; border-radius: 8px; background: white; text-align: left; cursor: pointer; font-size: 15px; transition: all 0.15s;">
                                                <span style="font-size: 20px; margin-right: 12px;">üîß</span>
                                                <strong>Wrong or Missing Part</strong>
                                            </button>
                                            <button type="button" onclick="selectOfficeNotCompletedReason('access')" class="reason-btn"
                                                    style="padding: 16px 20px; border: 2px solid #dee2e6; border-radius: 8px; background: white; text-align: left; cursor: pointer; font-size: 15px; transition: all 0.15s;">
                                                <span style="font-size: 20px; margin-right: 12px;">üö™</span>
                                                <strong>Can't Access Site</strong>
                                            </button>
                                            <button type="button" onclick="selectOfficeNotCompletedReason('more_work')" class="reason-btn"
                                                    style="padding: 16px 20px; border: 2px solid #dee2e6; border-radius: 8px; background: white; text-align: left; cursor: pointer; font-size: 15px; transition: all 0.15s;">
                                                <span style="font-size: 20px; margin-right: 12px;">‚ö†Ô∏è</span>
                                                <strong>Additional Work Needed</strong>
                                            </button>
                                            <button type="button" onclick="selectOfficeNotCompletedReason('equipment')" class="reason-btn"
                                                    style="padding: 16px 20px; border: 2px solid #dee2e6; border-radius: 8px; background: white; text-align: left; cursor: pointer; font-size: 15px; transition: all 0.15s;">
                                                <span style="font-size: 20px; margin-right: 12px;">üèóÔ∏è</span>
                                                <strong>Equipment Issue</strong>
                                            </button>
                                            <button type="button" onclick="selectOfficeNotCompletedReason('other')" class="reason-btn"
                                                    style="padding: 16px 20px; border: 2px solid #dee2e6; border-radius: 8px; background: white; text-align: left; cursor: pointer; font-size: 15px; transition: all 0.15s;">
                                                <span style="font-size: 20px; margin-right: 12px;">üìù</span>
                                                <strong>Other</strong>
                                            </button>
                                        </div>
                                        <input type="hidden" id="woNotCompletedReason" value="">

                                        <!-- Details Section (shown after reason selected) -->
                                        <div id="woReasonDetails" class="hidden" style="margin-top: 20px;">

                                            <!-- Selected reason header -->
                                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; padding: 12px; background: #ffebee; border-radius: 8px;">
                                                <span id="woSelectedReasonText" style="font-weight: 600; color: #c62828;"></span>
                                                <button type="button" onclick="changeOfficeReason()" style="background: none; border: none; color: #1976d2; cursor: pointer; font-size: 14px;">Change</button>
                                            </div>

                                            <!-- Wrong Part Section -->
                                            <div id="woWrongPartSection" class="hidden" style="margin-bottom: 16px; padding: 16px; background: #fff8e1; border-radius: 8px; border: 2px solid #ff9800;">
                                                <h4 style="font-size: 15px; font-weight: 700; color: #e65100; margin-bottom: 16px;">üìê Measurements & Photo Required</h4>

                                                <div class="form-group">
                                                    <label class="form-label" style="font-weight: 600;">Measurements of Correct Part</label>
                                                    <textarea id="woWrongPartMeasurements" class="form-input" rows="3"
                                                              placeholder="Length, width, thickness, hole spacing, bolt size..."
                                                              style="font-size: 16px;"></textarea>
                                                </div>

                                                <div class="form-group" style="margin-top: 16px;">
                                                    <label class="form-label" style="font-weight: 600;">üì∑ Photo of a CORRECT Part</label>
                                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 8px;">Photo of a working part that needs to be matched</p>
                                                    <div id="woWrongPartPhotoArea" style="border: 2px dashed #ff9800; border-radius: 8px; padding: 20px; text-align: center; cursor: pointer; background: white;"
                                                         onclick="document.getElementById('woWrongPartPhotoInput').click()">
                                                        <span style="font-size: 28px;">üì∑</span>
                                                        <p style="font-weight: 600; color: #e65100; margin-top: 8px;">Click to upload photo of working part</p>
                                                        <input type="file" id="woWrongPartPhotoInput" accept="image/*" style="display: none;" onchange="handleOfficeWrongPartPhoto(event, 'correct')">
                                                    </div>
                                                    <div id="woWrongPartPhotoPreview" class="hidden" style="margin-top: 12px;"></div>
                                                </div>

                                                <div class="form-group" style="margin-top: 12px;">
                                                    <div style="border: 1px dashed #dee2e6; border-radius: 8px; padding: 12px; text-align: center; cursor: pointer; background: white;"
                                                         onclick="document.getElementById('woWrongPartSentPhotoInput').click()">
                                                        <span style="color: #6c757d; font-size: 14px;">+ Photo of wrong part sent (optional)</span>
                                                        <input type="file" id="woWrongPartSentPhotoInput" accept="image/*" style="display: none;" onchange="handleOfficeWrongPartPhoto(event, 'wrong')">
                                                    </div>
                                                    <div id="woWrongPartSentPhotoPreview" style="margin-top: 8px;"></div>
                                                </div>
                                            </div>

                                            <!-- More Work Section - needs a photo -->
                                            <div id="woMoreWorkSection" class="hidden" style="margin-bottom: 16px; padding: 16px; background: #e3f2fd; border-radius: 8px; border: 2px solid #2196f3;">
                                                <h4 style="font-size: 15px; font-weight: 700; color: #1565c0; margin-bottom: 12px;">üì∑ Photo of the Issue</h4>
                                                <div id="woMoreWorkPhotoArea" style="border: 2px dashed #2196f3; border-radius: 8px; padding: 20px; text-align: center; cursor: pointer; background: white;"
                                                     onclick="document.getElementById('woMoreWorkPhotoInput').click()">
                                                    <span style="font-size: 28px;">üì∑</span>
                                                    <p style="font-weight: 600; color: #1565c0; margin-top: 8px;">Click to upload photo of the damage/issue</p>
                                                    <input type="file" id="woMoreWorkPhotoInput" accept="image/*" style="display: none;" onchange="handleOfficeMoreWorkPhoto(event)">
                                                </div>
                                                <div id="woMoreWorkPhotoPreview" class="hidden" style="margin-top: 12px;"></div>
                                            </div>

                                            <!-- Notes field -->
                                            <div class="form-group">
                                                <label class="form-label" style="font-weight: 600;">
                                                    Notes <span id="woNotesRequired" style="color: #dc3545;">*Required</span>
                                                </label>
                                                <textarea id="woNotCompletedDetails" class="form-input" rows="3"
                                                          placeholder="Explain what happened..."
                                                          style="font-size: 16px;"></textarea>
                                            </div>

                                            <button class="btn" onclick="submitOfficeJobNotCompleted()"
                                                    style="width: 100%; padding: 16px; font-size: 16px; background: #c62828; border-color: #c62828; color: white; margin-top: 16px;">
                                                Mark as Pink Job
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Column -->
                            <div>
                                <!-- Actions Card -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Actions</h2>
                                    </div>
                                    <div class="card-body">
                                        <button class="btn btn-outline" style="width: 100%; margin-bottom: 12px;">üìÑ Print Work Order</button>
                                        <button class="btn btn-outline" style="width: 100%; margin-bottom: 12px;">üìß Email to Tech</button>
                                        <button class="btn btn-secondary" style="width: 100%;">‚úÖ Mark Complete</button>
                                    </div>
                                </div>

                                <!-- Timeline Card -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Timeline</h2>
                                    </div>
                                    <div class="card-body" style="font-size: 13px;">
                                        <div style="border-left: 2px solid #e9ecef; padding-left: 16px; margin-left: 8px;">
                                            <div style="margin-bottom: 16px; position: relative;">
                                                <div style="position: absolute; left: -22px; top: 0; width: 12px; height: 12px; background: #4CAF50; border-radius: 50%;"></div>
                                                <div style="font-weight: 600;">Estimate Created</div>
                                                <div style="color: #6c757d;">Jan 15, 2026 ‚Ä¢ Lisa</div>
                                            </div>
                                            <div style="margin-bottom: 16px; position: relative;">
                                                <div style="position: absolute; left: -22px; top: 0; width: 12px; height: 12px; background: #4CAF50; border-radius: 50%;"></div>
                                                <div style="font-weight: 600;">Customer Accepted</div>
                                                <div style="color: #6c757d;">Jan 18, 2026</div>
                                            </div>
                                            <div style="margin-bottom: 16px; position: relative;">
                                                <div style="position: absolute; left: -22px; top: 0; width: 12px; height: 12px; background: #4CAF50; border-radius: 50%;"></div>
                                                <div style="font-weight: 600;">Parts Ordered</div>
                                                <div style="color: #6c757d;">Jan 19, 2026 ‚Ä¢ Charles</div>
                                            </div>
                                            <div style="margin-bottom: 16px; position: relative;">
                                                <div style="position: absolute; left: -22px; top: 0; width: 12px; height: 12px; background: #4CAF50; border-radius: 50%;"></div>
                                                <div style="font-weight: 600;">Parts Received</div>
                                                <div style="color: #6c757d;">Jan 21, 2026 ‚Ä¢ Samantha</div>
                                            </div>
                                            <div style="margin-bottom: 16px; position: relative;">
                                                <div style="position: absolute; left: -22px; top: 0; width: 12px; height: 12px; background: #2196F3; border-radius: 50%;"></div>
                                                <div style="font-weight: 600;">Job Confirmed</div>
                                                <div style="color: #6c757d;">Jan 23, 2026 ‚Ä¢ Savannah</div>
                                            </div>
                                            <div style="position: relative;">
                                                <div style="position: absolute; left: -22px; top: 0; width: 12px; height: 12px; background: #e9ecef; border-radius: 50%; border: 2px solid #2196F3;"></div>
                                                <div style="font-weight: 600; color: #2196F3;">Scheduled</div>
                                                <div style="color: #6c757d;">Jan 22, 2026</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Related Docs Card -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Documents</h2>
                                    </div>
                                    <div class="card-body">
                                        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                            <div style="text-align: center; padding: 12px; background: #f8f9fa; border-radius: 8px; cursor: pointer;">
                                                <div style="font-size: 32px;">üìÑ</div>
                                                <div style="font-size: 12px; margin-top: 4px;">Work Order</div>
                                            </div>
                                            <div style="text-align: center; padding: 12px; background: #f8f9fa; border-radius: 8px; cursor: pointer;">
                                                <div style="font-size: 32px;">üìã</div>
                                                <div style="font-size: 12px; margin-top: 4px;">Inspection</div>
                                            </div>
                                            <div style="text-align: center; padding: 12px; background: #f8f9fa; border-radius: 8px; cursor: pointer;">
                                                <div style="font-size: 32px;">üíµ</div>
                                                <div style="font-size: 12px; margin-top: 4px;">Estimate</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Field Staff Dashboard -->
    <div id="techDashboard" class="hidden">
        <div class="app-layout">
            <button class="mobile-menu-btn" onclick="toggleMobileMenu('techSidebar')">
                <img src="bleachers-logo-icon.png" alt="Menu">
            </button>
            <div class="sidebar-backdrop" id="techSidebarBackdrop" onclick="closeMobileMenu('techSidebar')"></div>
            <div class="sidebar" id="techSidebar">
                <div class="sidebar-header" onclick="toggleSidebar('techSidebar')">
                    <img src="bleachers-logo-icon.png" alt="Bleachers & Seats" class="sidebar-logo-icon">
                    <img src="menu-logo-wide.png" alt="Bleachers & Seats" class="sidebar-logo-full">
                    <div class="sidebar-close-btn">‚úï</div>
                </div>
                <div class="sidebar-nav">
                    <!-- Home -->
                    <div class="nav-item active" data-view="home" onclick="showTechView('home')">
                        <span>üè†</span>
                        <span>Home</span>
                    </div>

                    <!-- Search -->
                    <div class="nav-item" data-view="search" onclick="showTechView('search')">
                        <span>üîç</span>
                        <span>Search</span>
                    </div>

                    <!-- Inspections & Service -->
                    <div class="sidebar-divider" style="margin: 12px 20px; border-top: 1px solid rgba(255,255,255,0.15); position: relative;">
                        <span style="position: absolute; top: -8px; left: 50%; transform: translateX(-50%); background: #2d3748; padding: 0 8px; font-size: 10px; color: rgba(255,255,255,0.4); white-space: nowrap; text-transform: uppercase; letter-spacing: 1px;">Inspections & Service</span>
                    </div>
                    <div class="nav-item" data-view="myjobs" onclick="showTechView('myjobs')">
                        <span>üìÖ</span>
                        <span>My Jobs</span>
                    </div>
                    <div class="nav-item" data-view="teamschedule" onclick="showTechView('teamschedule')">
                        <span>üë•</span>
                        <span>Team Schedule</span>
                    </div>

                    <!-- Resources -->
                    <div class="sidebar-divider" style="margin: 12px 20px; border-top: 1px solid rgba(255,255,255,0.15); position: relative;">
                        <span style="position: absolute; top: -8px; left: 50%; transform: translateX(-50%); background: #2d3748; padding: 0 8px; font-size: 10px; color: rgba(255,255,255,0.4); white-space: nowrap; text-transform: uppercase; letter-spacing: 1px;">Resources</span>
                    </div>
                    <div class="nav-item" data-view="parts" onclick="showTechView('parts')">
                        <span>üîß</span>
                        <span>Parts Catalog</span>
                    </div>
                    <div class="nav-item" data-view="resources" onclick="showTechView('resources')">
                        <span>üìö</span>
                        <span>Employee Resources</span>
                    </div>

                    <!-- Bottom-aligned items -->
                    <div class="sidebar-spacer"></div>

                    <!-- Settings -->
                    <div class="nav-item" data-view="settings" onclick="showTechView('settings')">
                        <span>‚öôÔ∏è</span>
                        <span>Settings</span>
                    </div>
                </div>
                <div class="sidebar-footer">
                    <div class="user-info" onclick="logout()">
                        <div class="user-avatar" id="techUserAvatar">FS</div>
                        <div>
                            <div style="font-size: 14px; font-weight: 600;" id="techUserName">Field Staff</div>
                            <div style="font-size: 12px; opacity: 0.7;">Logout</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="main-content">
                <div class="content-area" style="padding-top: 24px;">
                    <!-- Home View -->
                    <div id="techHomeView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Home</h1>
                            <p class="page-subtitle">Welcome back</p>
                        </div>

                        <!-- Company Bulletin Board -->
                        <div id="techBulletinBoard" class="bulletin-board">
                            <!-- Populated by JS -->
                        </div>

                        <!-- Two Column: Notifications + Today's Jobs -->
                        <div class="home-panels">
                            <div class="home-panel" id="techNotificationsPanel">
                                <!-- Populated by JS -->
                            </div>
                            <div class="home-panel" id="techTodayPanel">
                                <!-- Populated by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Search View -->
                    <div id="techSearchView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Search</h1>
                            <p class="page-subtitle">Find any work order or inspection by school name or job number</p>
                        </div>

                        <div style="margin-bottom: 24px;">
                            <input type="text" id="techSearchInput" class="form-input" placeholder="Search by school name, job #, or keyword..." style="font-size: 16px; padding: 14px 16px;" oninput="performTechSearch()">
                        </div>

                        <div id="techSearchResults">
                            <div style="text-align: center; padding: 60px 20px; color: #6c757d;">
                                <div style="font-size: 48px; margin-bottom: 16px;">üîç</div>
                                <p style="font-size: 15px;">Search for a school, job number, or keyword to find work orders and inspections.</p>
                            </div>
                        </div>
                    </div>

                    <!-- My Jobs View (Personal Weekly Schedule) -->
                    <div id="techMyJobsView" class="hidden">
                        <div style="display: flex; justify-content: flex-start; margin-bottom: 16px;">
                            <button class="btn btn-primary" onclick="showTechView('fieldCreate')" style="padding: 10px 20px;">+ Create Job</button>
                        </div>
                        <div class="page-header">
                            <div>
                                <h1 class="page-title">My Jobs</h1>
                                <p class="page-subtitle">Your schedule for this week</p>
                                <div style="display: flex; gap: 12px; align-items: center; margin-top: 12px;">
                                    <button class="btn btn-outline" onclick="prevMyJobsWeek()" style="padding: 8px 12px;">‚Üê Prev</button>
                                    <span id="myJobsWeekLabel" style="font-weight: 600; min-width: 180px; text-align: center;"></span>
                                    <button class="btn btn-outline" onclick="nextMyJobsWeek()" style="padding: 8px 12px;">Next ‚Üí</button>
                                </div>
                            </div>
                        </div>

                        <div id="myJobsWeekGrid"></div>
                    </div>

                    <!-- Team Schedule View (Read-Only Full Schedule) -->
                    <div id="techTeamScheduleView" class="hidden">
                        <div class="page-header" style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <h1 class="page-title">Team Schedule</h1>
                                <p class="page-subtitle">Full crew schedule for the week</p>
                            </div>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <button class="btn btn-outline" onclick="prevTeamWeek()" style="padding: 8px 12px;">‚Üê Prev</button>
                                <span id="teamWeekLabel" style="font-weight: 600; min-width: 180px; text-align: center;"></span>
                                <button class="btn btn-outline" onclick="nextTeamWeek()" style="padding: 8px 12px;">Next ‚Üí</button>
                            </div>
                        </div>

                        <!-- Territory Tabs -->
                        <div style="display: flex; gap: 0; margin-bottom: 20px; border-bottom: 2px solid #e9ecef;">
                            <button class="schedule-tab active" onclick="switchTeamTerritory('original')" id="teamOriginalTab">Original Territory (KY/TN)</button>
                            <button class="schedule-tab" onclick="switchTeamTerritory('southern')" id="teamSouthernTab">Southern Territory (AL/FL)</button>
                        </div>

                        <div id="teamScheduleGrid"></div>
                    </div>

                    <!-- Field Create View -->
                    <div id="fieldCreateView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Create Job</h1>
                            <p class="page-subtitle">Start a new job</p>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Job Info</h2>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label">Job Type *</label>
                                    <select id="fieldCreateTypeSelect" class="form-select" onchange="onFieldCreateTypeChange()" style="font-size: 16px; padding: 14px;">
                                        <option value="">Select job type...</option>
                                        <option value="inspection">Inspection</option>
                                        <option value="work_order">Work Order</option>
                                        <option value="service_call">Service Call</option>
                                        <option value="go_see">Go-See</option>
                                        <option value="field_check">Field Check</option>
                                        <option value="custom">Custom</option>
                                    </select>
                                </div>

                                <!-- Custom job name field (shows right below Job Type when Custom selected) -->
                                <div id="fieldCreateCustomFields" class="hidden">
                                    <div class="form-group">
                                        <label class="form-label">Custom Job Name *</label>
                                        <input type="text" id="fieldCreateCustomName" class="form-input" placeholder="Enter custom job type..." style="font-size: 16px; padding: 14px;">
                                    </div>
                                </div>

                                <div id="fieldCreateFormFields" class="hidden">
                                    <div class="form-group">
                                        <label class="form-label">Customer / School *</label>
                                        <div style="position: relative;">
                                            <input type="text" id="fieldCreateCustomerSearch" class="form-input" placeholder="Start typing to search..." autocomplete="off" oninput="searchFieldCreateCustomers(this.value)" style="font-size: 16px; padding: 14px;">
                                            <div id="fieldCreateCustomerResults" class="customer-search-results hidden"></div>
                                            <input type="hidden" id="fieldCreateCustomerId">
                                            <input type="hidden" id="fieldCreateLocationId">
                                        </div>
                                    </div>
                                    <div id="fieldCreateCustomerInfo" class="hidden" style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-top: 8px; margin-bottom: 16px;">
                                        <p id="fieldCreateAddress" style="font-size: 13px; color: #6c757d;"></p>
                                        <p id="fieldCreateContact" style="font-size: 13px; color: #6c757d; margin-top: 4px;"></p>
                                    </div>

                                    <!-- Inspection-only fields -->
                                    <div id="fieldCreateInspectionFields" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">Inspection Type *</label>
                                            <select id="fieldCreateInspectionType" class="form-select" style="font-size: 16px; padding: 14px;">
                                                <option value="bleacher">Indoor Bleacher Inspection</option>
                                                <option value="outdoor">Outdoor Aluminum Bleacher Inspection</option>
                                                <option value="basketball">Basketball Goal Inspection</option>
                                            </select>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Job Number</label>
                                                <input type="text" id="fieldCreateJobNumber" class="form-input" readonly style="background: #e9ecef; font-weight: 700; font-size: 16px;">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Date</label>
                                                <input type="date" id="fieldCreateJobDate" class="form-input" style="font-size: 16px; padding: 14px;">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Description (Work Order + Parts Spec) -->
                                    <div id="fieldCreateDescriptionGroup" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">Description *</label>
                                            <textarea id="fieldCreateDescription" class="form-input" rows="3" placeholder="What needs to be done..." style="font-size: 16px; padding: 14px;"></textarea>
                                        </div>
                                    </div>

                                    <!-- Notes (all types) -->
                                    <div class="form-group">
                                        <label class="form-label">Notes</label>
                                        <textarea id="fieldCreateNotes" class="form-input" rows="2" placeholder="Any additional details..." style="font-size: 16px; padding: 14px;"></textarea>
                                    </div>

                                    <!-- Photo (Work Order + Parts Spec) -->
                                    <div id="fieldCreatePhotoGroup" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">Photo</label>
                                            <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                                <label style="width: 80px; height: 80px; border: 2px dashed #dee2e6; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 24px; color: #adb5bd;">
                                                    üì∑
                                                    <input type="file" accept="image/*" style="display: none;" onchange="handleFieldCreatePhoto(this)">
                                                </label>
                                                <div id="fieldCreatePhotoPreview"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button id="fieldCreateSubmitBtn" class="btn btn-primary btn-lg hidden" onclick="submitFieldCreate()" style="width: 100%; margin-top: 16px; padding: 16px; font-size: 16px;">Create</button>
                    </div>

                    <!-- Tech Parts Catalog View -->
                    <div id="techPartsView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Parts Catalog</h1>
                            <p class="page-subtitle">Search parts across all vendors</p>
                        </div>

                        <div class="card">
                            <div class="card-body">
                                <div class="form-group">
                                    <input type="text" id="techPartSearchInput" class="form-input" placeholder="Search by part name, number, or description..." style="font-size: 16px; padding: 14px 16px;" oninput="searchTechParts()">
                                </div>
                                <div id="techPartSearchResults" style="margin-top: 16px;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Tech Employee Resources View -->
                    <div id="techResourcesView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Employee Resources</h1>
                            <p class="page-subtitle">Company guides and reference materials</p>
                        </div>
                        <div class="card">
                            <div class="card-body">
                                <div style="display: flex; align-items: center; gap: 16px; padding: 16px; border: 1px solid #e9ecef; border-radius: 8px;">
                                    <span style="font-size: 32px;">üìÑ</span>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; font-size: 16px;">Employee Resource Guide</div>
                                        <div style="font-size: 13px; color: #6c757d; margin-top: 4px;">Company policies, procedures, and reference information</div>
                                    </div>
                                    <a href="https://acrobat.adobe.com/id/urn:aaid:sc:VA6C2:ac06edc3-d318-4f93-abc8-e4f281817ec9"
                                       target="_blank" class="btn btn-primary">Open Guide</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tech Settings View -->
                    <div id="techSettingsView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Settings</h1>
                            <p class="page-subtitle">Your profile information</p>
                        </div>

                        <!-- Profile Section -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Profile</h2>
                            </div>
                            <div class="card-body">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label class="form-label">Name</label>
                                        <input type="text" id="techSettingsUserName" class="form-input" placeholder="Your name">
                                    </div>
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label class="form-label">Phone</label>
                                        <input type="tel" id="techSettingsUserPhone" class="form-input" placeholder="(555) 123-4567">
                                    </div>
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label class="form-label">Email</label>
                                        <input type="email" id="techSettingsUserEmail" class="form-input" placeholder="you@example.com">
                                    </div>
                                </div>
                                <div style="margin-top: 16px;">
                                    <button class="btn btn-primary" onclick="saveTechUserProfile()">Save Profile</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tech Inspections View (Job List) -->
                    <div id="techInspectionsView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Inspections</h1>
                            <p class="page-subtitle">Create and manage inspection jobs</p>
                        </div>

                        <div style="display: flex; gap: 12px; margin-bottom: 24px;">
                            <button class="btn btn-primary btn-lg" onclick="startNewJob()">+ New Job</button>
                        </div>

                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="inProgressJobsCount">0</div>
                                <div class="stat-label">In Progress</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="submittedJobsCount">0</div>
                                <div class="stat-label">Submitted</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="totalBanksCount">0</div>
                                <div class="stat-label">Banks Inspected</div>
                            </div>
                        </div>

                        <!-- In Progress Jobs -->
                        <div class="card">
                            <div class="card-header" style="background: #fff3e0;">
                                <h2 class="card-title" style="color: #e65100;">üîÑ In Progress</h2>
                            </div>
                            <div class="card-body" id="inProgressJobsList" style="padding: 0;"></div>
                        </div>

                        <!-- Submitted Jobs -->
                        <div class="card">
                            <div class="card-header" style="background: #e8f5e9;">
                                <h2 class="card-title" style="color: #2e7d32;">‚úÖ Submitted</h2>
                            </div>
                            <div class="card-body" id="submittedJobsList" style="padding: 0;"></div>
                        </div>
                    </div>

                    <!-- Create View (Unified Form) -->
                    <div id="techCreateView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">Create</h1>
                            <p class="page-subtitle">Start a new job</p>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Job Info</h2>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label">Job Type *</label>
                                    <select id="createTypeSelect" class="form-select" onchange="onCreateTypeChange()" style="font-size: 16px; padding: 14px;">
                                        <option value="">Select job type...</option>
                                        <option value="inspection">Inspection</option>
                                        <option value="work_order">Work Order</option>
                                        <option value="service_call">Service Call</option>
                                        <option value="go_see">Go-See</option>
                                        <option value="field_check">Field Check</option>
                                        <option value="custom">Custom</option>
                                    </select>
                                </div>

                                <!-- Custom job name field (shows right below Job Type when Custom selected) -->
                                <div id="createCustomFields" class="hidden">
                                    <div class="form-group">
                                        <label class="form-label">Custom Job Name *</label>
                                        <input type="text" id="createCustomName" class="form-input" placeholder="Enter custom job type..." style="font-size: 16px; padding: 14px;">
                                    </div>
                                </div>

                                <!-- Everything below hidden until type selected -->
                                <div id="createFormFields" class="hidden">
                                    <div class="form-group">
                                        <label class="form-label">Customer / School *</label>
                                        <div style="position: relative;">
                                            <input type="text" id="createCustomerSearch" class="form-input" placeholder="Start typing to search..." autocomplete="off" oninput="searchCreateCustomers(this.value)" style="font-size: 16px; padding: 14px;">
                                            <div id="createCustomerResults" class="customer-search-results hidden"></div>
                                            <input type="hidden" id="createCustomerId">
                                            <input type="hidden" id="createLocationId">
                                        </div>
                                    </div>
                                    <div id="createCustomerInfo" class="hidden" style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-top: 8px; margin-bottom: 16px;">
                                        <p id="createAddress" style="font-size: 13px; color: #6c757d;"></p>
                                        <p id="createContact" style="font-size: 13px; color: #6c757d; margin-top: 4px;"></p>
                                    </div>

                                    <!-- Inspection-only fields -->
                                    <div id="createInspectionFields" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">Inspection Type *</label>
                                            <select id="createInspectionType" class="form-select" style="font-size: 16px; padding: 14px;">
                                                <option value="bleacher">Indoor Bleacher Inspection</option>
                                                <option value="outdoor">Outdoor Aluminum Bleacher Inspection</option>
                                                <option value="basketball">Basketball Goal Inspection</option>
                                            </select>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Job Number</label>
                                                <input type="text" id="createJobNumber" class="form-input" readonly style="background: #e9ecef; font-weight: 700; font-size: 16px;">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Date</label>
                                                <input type="date" id="createJobDate" class="form-input" style="font-size: 16px; padding: 14px;">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Description (Work Order + Parts Spec) -->
                                    <div id="createDescriptionGroup" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">Description *</label>
                                            <textarea id="createDescription" class="form-input" rows="3" placeholder="What needs to be done..." style="font-size: 16px; padding: 14px;"></textarea>
                                        </div>
                                    </div>

                                    <!-- Notes (all types) -->
                                    <div class="form-group">
                                        <label class="form-label">Notes</label>
                                        <textarea id="createNotes" class="form-input" rows="2" placeholder="Any additional details..." style="font-size: 16px; padding: 14px;"></textarea>
                                    </div>

                                    <!-- Photo (Work Order + Parts Spec) -->
                                    <div id="createPhotoGroup" class="hidden">
                                        <div class="form-group">
                                            <label class="form-label">Photo</label>
                                            <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                                <label style="width: 80px; height: 80px; border: 2px dashed #dee2e6; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 24px; color: #adb5bd;">
                                                    üì∑
                                                    <input type="file" accept="image/*" capture="environment" style="display: none;" onchange="handleCreatePhoto(this)">
                                                </label>
                                                <div id="createPhotoPreview"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button id="createSubmitBtn" class="btn btn-primary btn-lg hidden" onclick="submitCreate()" style="width: 100%; margin-top: 16px; padding: 16px; font-size: 16px;">Create</button>
                    </div>

                    <!-- New Job Setup (used by office-side startNewJob) -->
                    <div id="newJobSetupView" class="hidden">
                        <div class="page-header">
                            <button class="btn btn-secondary" onclick="goBackFromInspection()">‚Üê Back</button>
                            <h1 class="page-title" style="margin-top: 16px;">New Inspection</h1>
                            <p class="page-subtitle">Create a new inspection job</p>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Job Info</h2>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label">Customer / School *</label>
                                    <select id="jobCustomerSelect" class="form-select" onchange="updateJobCustomerInfo()" style="font-size: 16px; padding: 14px;">
                                        <option value="">Select a customer...</option>
                                    </select>
                                </div>
                                <div id="jobCustomerInfo" class="hidden" style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-top: 8px; margin-bottom: 16px;">
                                    <p id="jobBillingEntity" style="font-size: 13px; color: #6c757d;"></p>
                                    <p id="jobServiceLocation" style="font-weight: 600;"></p>
                                    <p id="jobServiceAddress" style="font-size: 13px; color: #6c757d; margin-top: 4px;"></p>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Inspection Type *</label>
                                    <select id="jobInspectionType" class="form-select" style="font-size: 16px; padding: 14px;">
                                        <option value="bleacher">Indoor Bleacher Inspection</option>
                                        <option value="outdoor">Outdoor Aluminum Bleacher Inspection</option>
                                        <option value="basketball">Basketball Goal Inspection</option>
                                    </select>
                                </div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <div class="form-group">
                                        <label class="form-label">Job Number</label>
                                        <input type="text" id="jobNumberInput" class="form-input" readonly style="background: #e9ecef; font-weight: 700; font-size: 16px;">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Date</label>
                                        <input type="date" id="jobDateInput" class="form-input" style="font-size: 16px; padding: 14px;">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Notes</label>
                                    <textarea id="jobNotes" class="form-input" rows="2" placeholder="Any additional details..." style="font-size: 16px; padding: 14px;"></textarea>
                                </div>
                            </div>
                        </div>

                        <button class="btn btn-primary btn-lg" onclick="createJobAndAddBank()" style="width: 100%; margin-top: 16px; padding: 16px; font-size: 16px;">
                            Create Inspection
                        </button>
                    </div>

                    <!-- Bank Inspection Form (Issue-First, Top-Side-First) -->
                    <div id="bankInspectionView" class="hidden" style="position: relative; padding-bottom: 100px;">
                        <!-- Floating Add Issue Button -->
                        <div id="floatingAddIssue" style="position: fixed; bottom: 24px; right: 24px; z-index: 1000;">
                            <button class="btn btn-primary" onclick="openAddIssueModal()" style="width: 64px; height: 64px; border-radius: 50%; font-size: 28px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center;">
                                +
                            </button>
                            <div style="text-align: center; margin-top: 4px; font-size: 11px; font-weight: 600; color: #4CAF50;">ADD ISSUE</div>
                        </div>

                        <!-- Job Header -->
                        <div style="background: #2d3748; color: white; padding: 16px 24px; margin: -24px -32px 24px -32px; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 12px; opacity: 0.7;">Job #<span id="bankJobNumber"></span></div>
                                <div style="font-size: 18px; font-weight: 700;" id="bankCustomerName"></div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 12px; opacity: 0.7;">Banks: <span id="bankCount">0</span></div>
                                <button class="btn btn-outline" onclick="goBackToJobList()" style="color: white; border-color: rgba(255,255,255,0.3); margin-top: 4px; font-size: 12px; padding: 6px 12px;">Save & Exit</button>
                            </div>
                        </div>

                        <!-- Bank Tabs -->
                        <div id="bankTabs" style="display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap;">
                            <!-- Populated dynamically -->
                        </div>

                        <!-- Current Bank Form -->
                        <div class="card" style="border-left: 4px solid #4CAF50;">
                            <div class="card-header" style="background: #e8f5e9;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <h2 class="card-title" style="color: #2e7d32;">
                                        <span id="currentBankName">Bank 1</span>
                                        <span id="editBankNameBtn" onclick="editBankName()" style="font-size: 12px; color: #4CAF50; cursor: pointer; margin-left: 8px;">‚úèÔ∏è Edit</span>
                                    </h2>
                                    <select id="bankNameSelect" class="form-select" style="width: auto; display: none;" onchange="updateBankName()">
                                        <option value="East Side">East Side</option>
                                        <option value="West Side">West Side</option>
                                        <option value="Facing Logo">Facing Logo</option>
                                        <option value="Behind Logo">Behind Logo</option>
                                        <option value="North Side">North Side</option>
                                        <option value="South Side">South Side</option>
                                        <option value="Home Side">Home Side</option>
                                        <option value="Visitor Side">Visitor Side</option>
                                        <option value="Main Gym">Main Gym</option>
                                        <option value="Aux Gym">Aux Gym</option>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body">
                                <!-- Equipment Quick Info -->
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                                    <div class="form-group">
                                        <label class="form-label">Bleacher Type</label>
                                        <select id="bankBleacherType" class="form-select">
                                            <option value="">Select...</option>
                                            <option value="Hussey">Hussey</option>
                                            <option value="Irwin">Irwin</option>
                                            <option value="Interkal">Interkal</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Tiers</label>
                                        <input type="number" id="bankTiers" class="form-input" placeholder="e.g., 5">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Seat Type</label>
                                        <input type="text" id="bankSeatType" class="form-input" placeholder="e.g., Infinity">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Color</label>
                                        <input type="text" id="bankColor" class="form-input" placeholder="e.g., Red">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- TOP SIDE SECTION (First - matches physical walkthrough) -->
                        <div class="card">
                            <div class="card-header" style="background: #e3f2fd; cursor: pointer;" onclick="toggleSection('topSideSection')">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <h2 class="card-title" style="color: #1565c0;">üëü Top Side Inspection</h2>
                                    <span id="topSideToggle" style="font-size: 20px;">‚ñº</span>
                                </div>
                                <p style="font-size: 12px; color: #1565c0; margin-top: 4px;">Walk the bleachers, document issues as you find them</p>
                            </div>
                            <div class="card-body" id="topSideSection">
                                <!-- Seating Layout -->
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px solid #e9ecef;">
                                    <div class="form-group">
                                        <label class="form-label">Sections</label>
                                        <input type="number" id="bankSections" class="form-input" placeholder="e.g., 4">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Rows</label>
                                        <input type="number" id="bankRows" class="form-input" placeholder="e.g., 5">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Aisles</label>
                                        <input type="number" id="bankAisles" class="form-input" placeholder="e.g., 3">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Aisle Rail Type</label>
                                        <select id="bankAisleRailType" class="form-select">
                                            <option value="P">P Rail</option>
                                            <option value="F">F Rail</option>
                                            <option value="Q">Q Rail</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Top Side Issues List -->
                                <div style="margin-bottom: 16px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                        <h3 style="font-size: 14px; font-weight: 600; color: #1565c0;">Top Side Issues Found</h3>
                                        <button class="btn btn-outline" onclick="addTopSideIssue()" style="font-size: 12px; padding: 6px 12px;">+ Add Issue</button>
                                    </div>
                                    <div id="topSideIssuesList">
                                        <div style="text-align: center; padding: 24px; color: #6c757d; background: #f8f9fa; border-radius: 8px;">
                                            <div style="font-size: 32px; margin-bottom: 8px;">üëÄ</div>
                                            <p>No top side issues documented yet</p>
                                            <p style="font-size: 12px; margin-top: 4px;">Walk the bleachers and tap + to add issues</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Collapsible Checklist Reference -->
                                <details style="background: #f8f9fa; border-radius: 8px; padding: 12px;">
                                    <summary style="cursor: pointer; font-weight: 600; color: #6c757d;">üìã Inspection Checklist Reference</summary>
                                    <div id="topSideChecklist" style="margin-top: 12px;"></div>
                                </details>
                            </div>
                        </div>

                        <!-- UNDERSTRUCTURE SECTION (Second) -->
                        <div class="card">
                            <div class="card-header" style="background: #fce4ec; cursor: pointer;" onclick="toggleSection('understructureSection')">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <h2 class="card-title" style="color: #c2185b;">üîß Understructure Inspection</h2>
                                    <span id="understructureToggle" style="font-size: 20px;">‚ñº</span>
                                </div>
                                <p style="font-size: 12px; color: #c2185b; margin-top: 4px;">Crawl underneath, check motors, frames, wheels</p>
                            </div>
                            <div class="card-body" id="understructureSection">
                                <!-- Motor Specs -->
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px solid #e9ecef;">
                                    <div class="form-group">
                                        <label class="form-label">Motor Phase</label>
                                        <select id="bankMotorPhase" class="form-select">
                                            <option value="Single">Single Phase</option>
                                            <option value="3">3 Phase</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">HP</label>
                                        <input type="text" id="bankMotorHP" class="form-input" placeholder="e.g., 1/2">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label"># of Motors</label>
                                        <input type="number" id="bankMotorCount" class="form-input" placeholder="e.g., 3">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Wheel Type</label>
                                        <input type="text" id="bankWheelType" class="form-input" placeholder="e.g., Wide Track">
                                    </div>
                                </div>

                                <!-- Understructure Issues List -->
                                <div style="margin-bottom: 16px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                        <h3 style="font-size: 14px; font-weight: 600; color: #c2185b;">Understructure Issues Found</h3>
                                        <button class="btn btn-outline" onclick="addUnderstructureIssue()" style="font-size: 12px; padding: 6px 12px;">+ Add Issue</button>
                                    </div>
                                    <div id="understructureIssuesList">
                                        <div style="text-align: center; padding: 24px; color: #6c757d; background: #f8f9fa; border-radius: 8px;">
                                            <div style="font-size: 32px; margin-bottom: 8px;">üîç</div>
                                            <p>No understructure issues documented yet</p>
                                            <p style="font-size: 12px; margin-top: 4px;">Check motors, frames, wheels and tap + to add issues</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Collapsible Checklist Reference -->
                                <details style="background: #f8f9fa; border-radius: 8px; padding: 12px;">
                                    <summary style="cursor: pointer; font-weight: 600; color: #6c757d;">üìã Inspection Checklist Reference</summary>
                                    <div id="understructureChecklist" style="margin-top: 12px;"></div>
                                </details>
                            </div>
                        </div>

                        <!-- BANK SUMMARY -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Bank Summary</h2>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label" style="color: #dc3545;">‚ö†Ô∏è Safety Issues</label>
                                    <textarea id="bankSafetyIssues" class="form-textarea" placeholder="Describe any safety issues..." style="border-left: 4px solid #dc3545;"></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">üîß Functional / Mechanical Issues</label>
                                    <textarea id="bankMechanicalIssues" class="form-textarea" placeholder="Describe mechanical issues..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">‚ú® Cosmetic Issues</label>
                                    <textarea id="bankCosmeticIssues" class="form-textarea" placeholder="Describe cosmetic issues..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">üè∑Ô∏è Inspection Tag Affixed?</label>
                                    <select id="bankTagAffixed" class="form-select">
                                        <option value="yes">Yes</option>
                                        <option value="no">No</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Bank Actions -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 24px;">
                            <button class="btn btn-outline btn-lg" onclick="saveBankAndAddAnother()">
                                Save Bank & Add Another
                            </button>
                            <button class="btn btn-primary btn-lg" onclick="saveBankAndFinishJob()">
                                Finish This Job ‚úì
                            </button>
                        </div>
                    </div>

                    <!-- Add Issue Modal -->
                    <div id="addIssueModal" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 2000; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 16px; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto;">
                            <div style="padding: 20px; border-bottom: 1px solid #e9ecef;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <h2 style="font-size: 18px; font-weight: 700;">Add Issue</h2>
                                    <button onclick="closeAddIssueModal()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #6c757d;">√ó</button>
                                </div>
                            </div>
                            <div style="padding: 20px;">
                                <div class="form-group">
                                    <label class="form-label">Issue Type *</label>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                        <button type="button" id="issueTypeTopSide" class="btn btn-outline" onclick="selectIssueType('topSide')" style="padding: 16px; text-align: center;">
                                            <div style="font-size: 24px;">üëü</div>
                                            <div style="font-size: 13px; margin-top: 4px;">Top Side</div>
                                        </button>
                                        <button type="button" id="issueTypeUnder" class="btn btn-outline" onclick="selectIssueType('understructure')" style="padding: 16px; text-align: center;">
                                            <div style="font-size: 24px;">üîß</div>
                                            <div style="font-size: 13px; margin-top: 4px;">Understructure</div>
                                        </button>
                                    </div>
                                </div>

                                <div id="issueLocationFields" class="hidden">
                                    <!-- Top Side Location -->
                                    <div id="topSideLocationFields" class="hidden">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                                            <div class="form-group">
                                                <label class="form-label">Section</label>
                                                <input type="text" id="issueSection" class="form-input" placeholder="e.g., 2">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Row</label>
                                                <input type="text" id="issueRow" class="form-input" placeholder="e.g., 3">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Aisle</label>
                                                <input type="text" id="issueAisle" class="form-input" placeholder="e.g., 1">
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Understructure Location -->
                                    <div id="underLocationFields" class="hidden">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                            <div class="form-group">
                                                <label class="form-label">Frame</label>
                                                <input type="text" id="issueFrame" class="form-input" placeholder="e.g., 3">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Tier</label>
                                                <input type="text" id="issueTier" class="form-input" placeholder="e.g., 1">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Description *</label>
                                        <textarea id="issueDescription" class="form-textarea" placeholder="Describe the issue..." style="min-height: 80px;"></textarea>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">üì∑ Photo</label>
                                        <div id="issuePhotoPreview" style="width: 100%; height: 150px; background: #f8f9fa; border: 2px dashed #dee2e6; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; margin-bottom: 8px;" onclick="document.getElementById('issuePhotoInput').click()">
                                            <div style="text-align: center; color: #6c757d;">
                                                <div style="font-size: 32px;">üì∑</div>
                                                <div style="font-size: 13px;">Tap to take photo</div>
                                            </div>
                                        </div>
                                        <input type="file" id="issuePhotoInput" accept="image/*" capture="environment" style="display: none;" onchange="previewIssuePhoto(this)">
                                    </div>
                                </div>
                            </div>
                            <div style="padding: 20px; border-top: 1px solid #e9ecef;">
                                <button class="btn btn-primary btn-lg" onclick="saveIssue()" style="width: 100%;">Save Issue</button>
                            </div>
                        </div>
                    </div>

                    <!-- Job Summary / Finish View -->
                    <div id="jobSummaryView" class="hidden">
                        <div class="page-header">
                            <button class="btn btn-secondary" onclick="backToInspection()">‚Üê Back to Inspection</button>
                            <h1 class="page-title" style="margin-top: 16px;">Job Summary</h1>
                            <p class="page-subtitle">Review and submit inspection</p>
                        </div>

                        <div class="card" style="border-left: 4px solid #4CAF50;">
                            <div class="card-header">
                                <h2 class="card-title">Job #<span id="summaryJobNumber"></span></h2>
                            </div>
                            <div class="card-body">
                                <p style="font-size: 18px; font-weight: 600;" id="summaryCustomerName"></p>
                                <p style="color: #6c757d;" id="summaryAddress"></p>
                                <div style="margin-top: 16px; display: flex; gap: 16px;">
                                    <div style="background: #e8f5e9; padding: 12px 20px; border-radius: 8px; text-align: center;">
                                        <div style="font-size: 24px; font-weight: 700; color: #2e7d32;" id="summaryBankCount">0</div>
                                        <div style="font-size: 12px; color: #2e7d32;">Banks</div>
                                    </div>
                                    <div style="background: #fff3e0; padding: 12px 20px; border-radius: 8px; text-align: center;">
                                        <div style="font-size: 24px; font-weight: 700; color: #e65100;" id="summaryIssueCount">0</div>
                                        <div style="font-size: 12px; color: #e65100;">Issues</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Banks Inspected</h2>
                            </div>
                            <div class="card-body" id="summaryBanksList"></div>
                        </div>

                        <!-- Parts Section -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Parts Needed (<span id="summaryPartsCount">0</span>)</h2>
                            </div>
                            <div class="card-body">
                                <div id="summaryPartsList"></div>
                                <button class="btn btn-outline" onclick="openPartsSearch()" style="width: 100%; margin-top: 16px;">üîç Search & Add Parts</button>
                            </div>
                        </div>

                        <!-- Inspector Signature -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Inspector Certification</h2>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label">Inspector Name</label>
                                    <input type="text" id="inspectorName" class="form-input" value="Danny Mendl">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Certificate Number</label>
                                    <input type="text" id="inspectorCertificate" class="form-input" value="MXM00-980">
                                </div>
                            </div>
                        </div>

                        <button class="btn btn-primary btn-lg" onclick="submitJob()" style="width: 100%;">
                            ‚úÖ Submit Inspection
                        </button>
                    </div>

                    <!-- Legacy New Inspection Form (kept for compatibility) -->
                    <div id="newInspectionView" class="hidden">
                        <div class="page-header">
                            <button class="btn btn-secondary" onclick="goBackFromInspection()">‚Üê Back</button>
                            <h1 class="page-title" style="margin-top: 16px;">New Inspection</h1>
                            <p class="page-subtitle">Select inspection type and complete the form</p>
                        </div>

                        <!-- Inspection Type Selection -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Inspection Type *</h2>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <select id="inspectionTypeSelect" class="form-select" onchange="onInspectionTypeChange()" style="font-size: 16px; padding: 14px;">
                                        <option value="">Select inspection type...</option>
                                        <option value="basketball">üèÄ Basketball Goal Inspection</option>
                                        <option value="bleacher">üèüÔ∏è Indoor Bleacher Inspection</option>
                                        <option value="outdoor">ü™ë Outdoor Aluminum Bleacher Inspection</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Common: Customer Info (shown after type selected) -->
                        <div id="inspectionFormFields" class="hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Customer Information</h2>
                                </div>
                                <div class="card-body">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                        <div class="form-group">
                                            <label class="form-label">Customer / School *</label>
                                            <select id="customerSelect" class="form-select" onchange="updateCustomerInfo()">
                                                <option value="">Select a customer</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Location / Gym Name</label>
                                            <input type="text" id="locationInput" class="form-input" placeholder="e.g., Main Gymnasium">
                                        </div>
                                    </div>
                                    <div id="customerInfo" class="hidden" style="background: #f8f9fa; padding: 16px; border-radius: 8px; margin-top: 16px;">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                            <div>
                                                <p style="font-size: 11px; text-transform: uppercase; color: #6c757d; margin-bottom: 4px;">Billing Entity</p>
                                                <p id="billingEntityName" style="font-weight: 600; margin-bottom: 2px;"></p>
                                                <p id="billingEntityContact" style="font-size: 13px; color: #6c757d;"></p>
                                            </div>
                                            <div>
                                                <p style="font-size: 11px; text-transform: uppercase; color: #6c757d; margin-bottom: 4px;">Service Location</p>
                                                <p id="customerName" style="font-weight: 600; margin-bottom: 2px;"></p>
                                                <p id="customerAddress" style="font-size: 13px; color: #6c757d;"></p>
                                                <p id="customerContact" style="font-size: 13px; color: #6c757d;"></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- BASKETBALL GOAL INSPECTION FIELDS -->
                            <div id="basketballFields" class="hidden">
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">üèÄ Basketball Equipment Overview</h2>
                                    </div>
                                    <div class="card-body">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Brand of Equipment</label>
                                                <select id="bbBrand" class="form-select">
                                                    <option value="">Select brand</option>
                                                    <option value="Spalding">Spalding</option>
                                                    <option value="Porter">Porter</option>
                                                    <option value="Draper">Draper</option>
                                                    <option value="Jaypro">Jaypro</option>
                                                    <option value="Other">Other</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">How Many Goals in Gym</label>
                                                <input type="number" id="bbGoalCount" class="form-input" placeholder="e.g., 4" min="1" max="8">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Gym Type</label>
                                                <select id="bbGymType" class="form-select">
                                                    <option value="Main">Main Gym</option>
                                                    <option value="Auxiliary">Auxiliary Gym</option>
                                                    <option value="Practice">Practice Gym</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-top: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Padding Color</label>
                                                <input type="text" id="bbPaddingColor" class="form-input" placeholder="e.g., Navy Blue">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Padding Dimensions</label>
                                                <input type="text" id="bbPaddingDimensions" class="form-input" placeholder="e.g., 72x42">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Ceiling Type</label>
                                                <select id="bbCeilingType" class="form-select">
                                                    <option value="">Select type</option>
                                                    <option value="Metal Girders with Secondary Trusses">Metal Girders with Secondary Trusses</option>
                                                    <option value="Open Steel Trusses">Open Steel Trusses</option>
                                                    <option value="Wood Trusses">Wood Trusses</option>
                                                    <option value="Concrete">Concrete</option>
                                                    <option value="Other">Other</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Per-Goal Inspection -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Goal Inspections</h2>
                                        <button class="btn btn-outline" onclick="addGoalInspection()">+ Add Goal</button>
                                    </div>
                                    <div class="card-body" id="goalInspectionsContainer">
                                        <p style="color: #6c757d; text-align: center;">Click "Add Goal" to inspect each basketball goal</p>
                                    </div>
                                </div>

                                <!-- Basketball Checklist -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Overall Checklist</h2>
                                    </div>
                                    <div class="card-body">
                                        <div id="bbChecklist"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- INDOOR BLEACHER INSPECTION FIELDS -->
                            <div id="bleacherFields" class="hidden">
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">üèüÔ∏è Bleacher Equipment Details</h2>
                                    </div>
                                    <div class="card-body">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Banks</label>
                                                <input type="text" id="blBanks" class="form-input" placeholder="e.g., 1 - Behind">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Tiers</label>
                                                <input type="number" id="blTiers" class="form-input" placeholder="e.g., 5">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Rise</label>
                                                <input type="text" id="blRise" class="form-input" placeholder='e.g., 10"'>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Row Spacing</label>
                                                <input type="text" id="blRowSpacing" class="form-input" placeholder='e.g., 24"'>
                                            </div>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 16px; margin-top: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Bleacher Type</label>
                                                <select id="blType" class="form-select">
                                                    <option value="">Select type</option>
                                                    <option value="Hussey">Hussey</option>
                                                    <option value="Irwin">Irwin</option>
                                                    <option value="Interkal">Interkal</option>
                                                    <option value="Other">Other</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Seat Type</label>
                                                <input type="text" id="blSeatType" class="form-input" placeholder="e.g., Infinity">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Material</label>
                                                <select id="blMaterial" class="form-select">
                                                    <option value="Plastic">Plastic</option>
                                                    <option value="Wood">Wood</option>
                                                    <option value="Aluminum">Aluminum</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Color</label>
                                                <input type="text" id="blColor" class="form-input" placeholder="e.g., Crimson">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Understructure Checklist -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Understructure Checklist</h2>
                                    </div>
                                    <div class="card-body">
                                        <div id="blUnderstructureChecklist"></div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-top: 20px; padding-top: 20px; border-top: 1px solid #e9ecef;">
                                            <div class="form-group">
                                                <label class="form-label">Motor Phase</label>
                                                <select id="blMotorPhase" class="form-select">
                                                    <option value="Single">Single Phase</option>
                                                    <option value="3">3 Phase</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">HP</label>
                                                <input type="text" id="blMotorHP" class="form-input" placeholder="e.g., 1/2">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Number of Motors</label>
                                                <input type="number" id="blMotorCount" class="form-input" placeholder="e.g., 3">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Top Side Checklist -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Top Side Checklist</h2>
                                    </div>
                                    <div class="card-body">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 20px;">
                                            <div class="form-group">
                                                <label class="form-label">Sections</label>
                                                <input type="number" id="blSections" class="form-input" placeholder="e.g., 3">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Rows</label>
                                                <input type="number" id="blRows" class="form-input" placeholder="e.g., 5">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Aisles</label>
                                                <input type="number" id="blAisles" class="form-input" placeholder="e.g., 2">
                                            </div>
                                        </div>
                                        <div id="blTopSideChecklist"></div>
                                    </div>
                                </div>

                                <!-- Issues Detail -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Issues Found</h2>
                                        <button class="btn btn-outline" onclick="addIssue('bleacher')">+ Add Issue</button>
                                    </div>
                                    <div class="card-body" id="bleacherIssuesContainer">
                                        <p style="color: #6c757d; text-align: center;">Click "Add Issue" to document problems found</p>
                                    </div>
                                </div>
                            </div>

                            <!-- OUTDOOR ALUMINUM BLEACHER FIELDS -->
                            <div id="outdoorFields" class="hidden">
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">ü™ë Aluminum Bleacher Details</h2>
                                    </div>
                                    <div class="card-body">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Type of Bleacher</label>
                                                <select id="outType" class="form-select">
                                                    <option value="">Select type</option>
                                                    <option value="Angle Frame">Angle Frame</option>
                                                    <option value="I-Beam">I-Beam</option>
                                                    <option value="Channel Frame">Channel Frame</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Number of Tiers</label>
                                                <input type="number" id="outTiers" class="form-input" placeholder="e.g., 15">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Bleacher Length</label>
                                                <input type="text" id="outLength" class="form-input" placeholder="e.g., 90'">
                                            </div>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-top: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Side (Orientation)</label>
                                                <select id="outSide" class="form-select">
                                                    <option value="Home">Home Side</option>
                                                    <option value="Visitor">Visitor Side</option>
                                                    <option value="Right">Right Side</option>
                                                    <option value="Left">Left Side</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Seat Width & Thickness</label>
                                                <input type="text" id="outSeatDimensions" class="form-input" placeholder='e.g., 9 1/2" x 1 3/4"'>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Seat Color</label>
                                                <input type="text" id="outSeatColor" class="form-input" placeholder="e.g., Natural Aluminum">
                                            </div>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 16px; margin-top: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Sections</label>
                                                <input type="number" id="outSections" class="form-input" placeholder="e.g., 2">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Rows</label>
                                                <input type="number" id="outRows" class="form-input" placeholder="e.g., 15">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Rise</label>
                                                <input type="text" id="outRise" class="form-input" placeholder='e.g., 10"'>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Run</label>
                                                <input type="text" id="outRun" class="form-input" placeholder='e.g., 23"'>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Outdoor Understructure Checklist -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Understructure Checklist</h2>
                                    </div>
                                    <div class="card-body">
                                        <div id="outUnderstructureChecklist"></div>
                                    </div>
                                </div>

                                <!-- Outdoor Top Side Checklist -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Top Side Checklist</h2>
                                    </div>
                                    <div class="card-body">
                                        <div id="outTopSideChecklist"></div>
                                    </div>
                                </div>

                                <!-- Code Compliance -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Code Compliance Issues</h2>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-group">
                                            <label class="form-label">Note gaps larger than 4", chain-link issues, ladder effect, etc.</label>
                                            <textarea id="outCodeIssues" class="form-textarea" placeholder="Describe any code compliance issues found..."></textarea>
                                        </div>
                                    </div>
                                </div>

                                <!-- Issues Detail -->
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Issues Found</h2>
                                        <button class="btn btn-outline" onclick="addIssue('outdoor')">+ Add Issue</button>
                                    </div>
                                    <div class="card-body" id="outdoorIssuesContainer">
                                        <p style="color: #6c757d; text-align: center;">Click "Add Issue" to document problems found</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Common: Manufacturer (shown for bleacher types) -->
                            <div id="manufacturerSection" class="hidden">
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title">Equipment Manufacturer</h2>
                                    </div>
                                    <div class="card-body">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                            <div class="form-group">
                                                <label class="form-label">Manufacturer</label>
                                                <select id="manufacturerSelect" class="form-select">
                                                    <option value="">Select manufacturer</option>
                                                    <option value="Hussey Seating Co">Hussey Seating Co</option>
                                                    <option value="Irwin">Irwin</option>
                                                    <option value="Draper">Draper</option>
                                                    <option value="Interkal">Interkal</option>
                                                    <option value="Porter">Porter</option>
                                                    <option value="Spalding">Spalding</option>
                                                    <option value="Other">Other</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Model</label>
                                                <input type="text" id="modelInput" class="form-input" placeholder="Model number if known">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Parts Search Section (shown for all types) -->
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Search & Add Parts</h2>
                                    <p style="font-size: 13px; color: #6c757d; margin-top: 4px;">Search 2,142 Hussey parts by name, part number, or category</p>
                                </div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label">Search Parts</label>
                                        <div style="display: flex; gap: 8px;">
                                            <input type="text" id="partSearch" class="form-input" style="flex: 1;" placeholder="Search by keyword or part # (e.g., 'wheel', 'seat board', '1001087')..." onkeyup="if(event.key==='Enter')searchParts()">
                                            <button type="button" class="btn btn-primary" onclick="searchParts()">Search</button>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Filter by Category (Optional)</label>
                                        <select id="vendorFilter" class="form-select" onchange="searchParts()">
                                            <option value="">All Categories</option>
                                        </select>
                                    </div>

                                    <div id="partsResults"></div>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Parts List (<span id="partsCount">0</span>)</h2>
                                </div>
                                <div class="card-body" id="selectedPartsList">
                                    <div class="empty-state">
                                        <div class="empty-icon">üì¶</div>
                                        <p>No parts added yet</p>
                                        <p style="font-size: 14px; margin-top: 8px;">Search and select parts above</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Summary Section -->
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Inspector Summary</h2>
                                </div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label">Safety Issues</label>
                                        <textarea id="safetyIssues" class="form-textarea" placeholder="Describe any safety issues found..." style="border-left: 4px solid #dc3545;"></textarea>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Functional / Mechanical Issues</label>
                                        <textarea id="mechanicalIssues" class="form-textarea" placeholder="Describe functional or mechanical issues..."></textarea>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Cosmetic Issues</label>
                                        <textarea id="cosmeticIssues" class="form-textarea" placeholder="Describe cosmetic issues..."></textarea>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Estimated Labor Hours</label>
                                        <input type="number" id="laborHours" class="form-input" placeholder="0" step="0.5" value="0">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Additional Service Notes</label>
                                        <textarea id="serviceNotes" class="form-textarea" placeholder="Any other notes..."></textarea>
                                    </div>

                                    <button class="btn btn-primary btn-lg" onclick="submitInspection()" style="width: 100%;">
                                        Submit Inspection Report
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tech Work Orders View -->
                    <div id="techWorkOrdersView" class="hidden">
                        <div class="page-header">
                            <h1 class="page-title">My Work Orders</h1>
                            <p class="page-subtitle">Tap a job to view details and submit completion</p>
                        </div>

                        <!-- Today's Jobs -->
                        <div class="card">
                            <div class="card-header" style="background: #e8f5e9;">
                                <h2 class="card-title" style="color: #2e7d32;">üìÖ Today - January 27, 2026</h2>
                            </div>
                            <div class="card-body" style="padding: 0;">
                                <!-- Work Order 1 -->
                                <div class="inspection-item" onclick="showTechWorkOrderDetail('two1')" style="cursor: pointer; border-left: 4px solid #4CAF50; margin: 0; border-radius: 0; border-bottom: 1px solid #e9ecef;">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                        <div>
                                            <div style="font-size: 12px; color: #4CAF50; font-weight: 600; margin-bottom: 4px;">Job #17208 ‚Ä¢ Repair</div>
                                            <strong style="font-size: 16px;">Ripley High School</strong>
                                            <p style="font-size: 13px; color: #6c757d; margin-top: 4px;">254 S Jefferson St, Ripley, TN</p>
                                            <p style="font-size: 14px; margin-top: 8px;">Install safety strap on Goal 5</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <span class="badge badge-success">8:00 AM</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Work Order 2 -->
                                <div class="inspection-item" onclick="showTechWorkOrderDetail('two2')" style="cursor: pointer; border-left: 4px solid #4CAF50; margin: 0; border-radius: 0; border-bottom: 1px solid #e9ecef;">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                        <div>
                                            <div style="font-size: 12px; color: #4CAF50; font-weight: 600; margin-bottom: 4px;">Job #17209 ‚Ä¢ Inspection</div>
                                            <strong style="font-size: 16px;">Ripley Middle School</strong>
                                            <p style="font-size: 13px; color: #6c757d; margin-top: 4px;">309 Charles Griggs St, Ripley, TN</p>
                                            <p style="font-size: 14px; margin-top: 8px;">Annual bleacher inspection - Main Gym</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <span class="badge badge-success">11:00 AM</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Work Order 3 -->
                                <div class="inspection-item" onclick="showTechWorkOrderDetail('two3')" style="cursor: pointer; border-left: 4px solid #4CAF50; margin: 0; border-radius: 0;">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                        <div>
                                            <div style="font-size: 12px; color: #4CAF50; font-weight: 600; margin-bottom: 4px;">Job #17210 ‚Ä¢ Repair</div>
                                            <strong style="font-size: 16px;">Brentwood Academy</strong>
                                            <p style="font-size: 13px; color: #6c757d; margin-top: 4px;">219 Granny White Pike, Brentwood, TN</p>
                                            <p style="font-size: 14px; margin-top: 8px;">Replace deck boards (3) and seat slats (5)</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <span class="badge badge-success">2:00 PM</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Upcoming Jobs -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">üìÜ Upcoming</h2>
                            </div>
                            <div class="card-body" style="padding: 0;">
                                <div class="inspection-item" style="margin: 0; border-radius: 0; border-bottom: 1px solid #e9ecef; opacity: 0.7;">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                        <div>
                                            <div style="font-size: 12px; color: #6c757d; font-weight: 600; margin-bottom: 4px;">Job #17211 ‚Ä¢ Repair</div>
                                            <strong style="font-size: 16px;">Franklin High School</strong>
                                            <p style="font-size: 13px; color: #6c757d; margin-top: 4px;">Motor replacement - Section A</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <span class="badge badge-secondary">Jan 28</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="inspection-item" style="margin: 0; border-radius: 0; opacity: 0.7;">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                        <div>
                                            <div style="font-size: 12px; color: #6c757d; font-weight: 600; margin-bottom: 4px;">Job #17212 ‚Ä¢ Inspection</div>
                                            <strong style="font-size: 16px;">Mt. Juliet High School</strong>
                                            <p style="font-size: 13px; color: #6c757d; margin-top: 4px;">Annual basketball goal inspection</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <span class="badge badge-secondary">Jan 29</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tech Work Order Detail View (Simplified for Field Staff) -->
                    <div id="techWorkOrderDetailView" class="hidden">
                        <div class="page-header">
                            <button class="btn btn-secondary" onclick="showTechView('create')" style="margin-bottom: 16px;">‚Üê Back</button>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <h1 class="page-title" style="margin: 0;" id="twoJobNumber">Job #17208</h1>
                                <span id="twoJobTypeBadge" class="badge badge-info">Repair</span>
                            </div>
                        </div>

                        <!-- Job Info Card (Read-Only) -->
                        <div class="card" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
                            <div class="card-body">
                                <!-- Location & Directions -->
                                <div style="margin-bottom: 20px;">
                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px; text-transform: uppercase; font-weight: 600;">Location</p>
                                    <h2 id="twoLocationName" style="font-size: 20px; font-weight: 700; margin-bottom: 4px;">Ripley High School</h2>
                                    <p id="twoAddress" style="font-size: 14px; color: #495057;">254 S Jefferson St, Ripley, TN 38063</p>
                                    <a id="twoDirectionsLink" href="https://maps.google.com/?q=254+S+Jefferson+St+Ripley+TN+38063" target="_blank"
                                       style="display: inline-flex; align-items: center; gap: 6px; margin-top: 8px; color: #0066cc; font-weight: 600; text-decoration: none;">
                                        üó∫Ô∏è Get Directions
                                    </a>
                                </div>

                                <!-- Contact -->
                                <div style="margin-bottom: 20px; padding: 12px; background: white; border-radius: 8px;">
                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 4px; text-transform: uppercase; font-weight: 600;">Site Contact</p>
                                    <p id="twoContactName" style="font-size: 16px; font-weight: 600; margin-bottom: 4px;"></p>
                                    <a id="twoContactPhone" href="tel:" style="color: #0066cc; font-weight: 600; text-decoration: none;">üìû </a>
                                </div>

                                <!-- What You're Doing -->
                                <div style="margin-bottom: 20px; padding: 16px; background: white; border-radius: 8px; border-left: 4px solid #4CAF50;">
                                    <p style="font-size: 12px; color: #6c757d; margin-bottom: 8px; text-transform: uppercase; font-weight: 600;">What You're Doing</p>
                                    <p id="twoDescription" style="font-size: 16px; line-height: 1.5;">Install safety strap on Goal 5. Lift rental required - 40' lift will be on site.</p>
                                </div>

                                <!-- Parts Location -->
                                <div style="padding: 12px; background: #fff3e0; border-radius: 8px; border-left: 4px solid #ff9800;">
                                    <p style="font-size: 12px; color: #e65100; margin-bottom: 4px; text-transform: uppercase; font-weight: 600;">üì¶ Parts Location</p>
                                    <p id="twoPartsLocation" style="font-size: 14px; font-weight: 600; color: #e65100;"></p>
                                </div>

                                <!-- Special Instructions (if any) -->
                                <div id="twoSpecialInstructionsSection" style="margin-top: 16px; padding: 12px; background: #e3f2fd; border-radius: 8px; border-left: 4px solid #2196F3;">
                                    <p style="font-size: 12px; color: #1565c0; margin-bottom: 4px; text-transform: uppercase; font-weight: 600;">‚ö†Ô∏è Special Instructions</p>
                                    <p id="twoSpecialInstructions" style="font-size: 14px; color: #1565c0;">Customer will have gym cleared by 8am. Enter through back door - front office doesn't open until 9.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Completion Section -->
                        <div class="card">
                            <div class="card-header" style="background: #4CAF50; color: white;">
                                <h2 class="card-title" style="color: white;">‚úÖ Job Completion</h2>
                            </div>
                            <div class="card-body">
                                <!-- Required Photo Upload -->
                                <div class="form-group">
                                    <label class="form-label" style="font-weight: 700;">
                                        üì∑ Completed Work Photo <span style="color: #dc3545;">*Required</span>
                                    </label>
                                    <p style="font-size: 13px; color: #6c757d; margin-bottom: 12px;">Take a photo showing the completed work</p>
                                    <div id="twoPhotoUploadArea" style="border: 2px dashed #dee2e6; border-radius: 8px; padding: 40px; text-align: center; cursor: pointer; background: #f8f9fa;"
                                         onclick="document.getElementById('twoPhotoInput').click()">
                                        <div style="font-size: 48px; margin-bottom: 12px;">üì∑</div>
                                        <p style="font-weight: 600; color: #495057;">Tap to take photo or upload</p>
                                        <input type="file" id="twoPhotoInput" accept="image/*" capture="environment" style="display: none;" onchange="handleTwoPhotoUpload(event)">
                                    </div>
                                    <div id="twoPhotoPreview" class="hidden" style="margin-top: 12px;"></div>
                                </div>

                                <!-- Additional Photos -->
                                <div class="form-group" style="margin-top: 20px;">
                                    <label class="form-label">üì∑ Additional Photos (Optional)</label>
                                    <p style="font-size: 13px; color: #6c757d; margin-bottom: 12px;">Add more photos if needed (issues found, before/after, etc.)</p>
                                    <div style="border: 2px dashed #dee2e6; border-radius: 8px; padding: 20px; text-align: center; cursor: pointer; background: #f8f9fa;"
                                         onclick="document.getElementById('twoAdditionalPhotos').click()">
                                        <p style="color: #6c757d;">+ Add more photos</p>
                                        <input type="file" id="twoAdditionalPhotos" accept="image/*" capture="environment" multiple style="display: none;" onchange="handleTwoAdditionalPhotos(event)">
                                    </div>
                                    <div id="twoAdditionalPhotosPreview" style="display: flex; flex-wrap: wrap; gap: 12px; margin-top: 12px;"></div>
                                </div>

                                <!-- Required Notes -->
                                <div class="form-group" style="margin-top: 20px;">
                                    <label class="form-label" style="font-weight: 700;">
                                        üìù Completion Notes <span style="color: #dc3545;">*Required</span>
                                    </label>
                                    <p style="font-size: 13px; color: #6c757d; margin-bottom: 12px;">Describe work completed (even "All work completed as specified" is fine)</p>
                                    <textarea id="twoCompletionNotes" class="form-input" rows="4"
                                              placeholder="Example: Installed safety strap on Goal 5. Tested operation - working properly. No additional issues found."
                                              style="font-size: 16px;"></textarea>
                                </div>

                                <!-- Completion Buttons -->
                                <div style="margin-top: 24px;">
                                    <button class="btn btn-primary btn-lg" onclick="submitJobCompleted()"
                                            style="width: 100%; padding: 20px; font-size: 18px; background: #4CAF50; border-color: #4CAF50;">
                                        ‚úÖ Job Completed - Submit
                                    </button>
                                </div>

                                <div style="margin-top: 16px; text-align: center;">
                                    <p style="font-size: 13px; color: #6c757d; margin-bottom: 12px;">Unable to complete?</p>
                                    <button class="btn btn-outline" onclick="showNotCompletedOptions()"
                                            style="width: 100%; padding: 16px; font-size: 16px; color: #dc3545; border-color: #dc3545;">
                                        ‚ùå Job Not Completed
                                    </button>
                                </div>

                                <!-- Not Completed Options (Hidden by default) -->
                                <div id="twoNotCompletedSection" class="hidden" style="margin-top: 20px; padding: 20px; background: #fff5f5; border-radius: 8px; border: 1px solid #ffcdd2;">
                                    <h3 style="font-size: 16px; font-weight: 700; color: #c62828; margin-bottom: 16px;">What happened?</h3>

                                    <!-- Reason Buttons (Step 1) -->
                                    <div id="twoReasonButtons" style="display: flex; flex-direction: column; gap: 10px;">
                                        <button type="button" onclick="selectNotCompletedReason('wrong_part')" class="reason-btn"
                                                style="padding: 16px 20px; border: 2px solid #dee2e6; border-radius: 8px; background: white; text-align: left; cursor: pointer; font-size: 15px; transition: all 0.15s;">
                                            <span style="font-size: 20px; margin-right: 12px;">üîß</span>
                                            <strong>Wrong or Missing Part</strong>
                                        </button>
                                        <button type="button" onclick="selectNotCompletedReason('access')" class="reason-btn"
                                                style="padding: 16px 20px; border: 2px solid #dee2e6; border-radius: 8px; background: white; text-align: left; cursor: pointer; font-size: 15px; transition: all 0.15s;">
                                            <span style="font-size: 20px; margin-right: 12px;">üö™</span>
                                            <strong>Can't Access Site</strong>
                                        </button>
                                        <button type="button" onclick="selectNotCompletedReason('more_work')" class="reason-btn"
                                                style="padding: 16px 20px; border: 2px solid #dee2e6; border-radius: 8px; background: white; text-align: left; cursor: pointer; font-size: 15px; transition: all 0.15s;">
                                            <span style="font-size: 20px; margin-right: 12px;">‚ö†Ô∏è</span>
                                            <strong>Additional Work Needed</strong>
                                        </button>
                                        <button type="button" onclick="selectNotCompletedReason('equipment')" class="reason-btn"
                                                style="padding: 16px 20px; border: 2px solid #dee2e6; border-radius: 8px; background: white; text-align: left; cursor: pointer; font-size: 15px; transition: all 0.15s;">
                                            <span style="font-size: 20px; margin-right: 12px;">üèóÔ∏è</span>
                                            <strong>Equipment Issue</strong>
                                        </button>
                                        <button type="button" onclick="selectNotCompletedReason('other')" class="reason-btn"
                                                style="padding: 16px 20px; border: 2px solid #dee2e6; border-radius: 8px; background: white; text-align: left; cursor: pointer; font-size: 15px; transition: all 0.15s;">
                                            <span style="font-size: 20px; margin-right: 12px;">üìù</span>
                                            <strong>Other</strong>
                                        </button>
                                    </div>
                                    <input type="hidden" id="twoNotCompletedReason" value="">

                                    <!-- Details Section (Step 2 - shown after reason selected) -->
                                    <div id="twoReasonDetails" class="hidden" style="margin-top: 20px;">

                                        <!-- Selected reason header -->
                                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; padding: 12px; background: #ffebee; border-radius: 8px;">
                                            <span id="twoSelectedReasonText" style="font-weight: 600; color: #c62828;"></span>
                                            <button type="button" onclick="changeReason()" style="background: none; border: none; color: #1976d2; cursor: pointer; font-size: 14px;">Change</button>
                                        </div>

                                        <!-- Wrong Part Section -->
                                        <div id="twoWrongPartSection" class="hidden" style="margin-bottom: 16px; padding: 16px; background: #fff8e1; border-radius: 8px; border: 2px solid #ff9800;">
                                            <h4 style="font-size: 15px; font-weight: 700; color: #e65100; margin-bottom: 16px;">üìê Measurements & Photo Required</h4>

                                            <div class="form-group">
                                                <label class="form-label" style="font-weight: 600;">Measurements of Correct Part</label>
                                                <textarea id="twoWrongPartMeasurements" class="form-input" rows="3"
                                                          placeholder="Length, width, thickness, hole spacing, bolt size..."
                                                          style="font-size: 16px;"></textarea>
                                            </div>

                                            <div class="form-group" style="margin-top: 16px;">
                                                <label class="form-label" style="font-weight: 600;">üì∑ Photo of a CORRECT Part</label>
                                                <p style="font-size: 12px; color: #6c757d; margin-bottom: 8px;">Find a working part nearby and photo it</p>
                                                <div id="twoWrongPartPhotoArea" style="border: 2px dashed #ff9800; border-radius: 8px; padding: 20px; text-align: center; cursor: pointer; background: white;"
                                                     onclick="document.getElementById('twoWrongPartPhotoInput').click()">
                                                    <span style="font-size: 28px;">üì∑</span>
                                                    <p style="font-weight: 600; color: #e65100; margin-top: 8px;">Tap to photo working part</p>
                                                    <input type="file" id="twoWrongPartPhotoInput" accept="image/*" capture="environment" style="display: none;" onchange="handleWrongPartPhotoUpload(event)">
                                                </div>
                                                <div id="twoWrongPartPhotoPreview" class="hidden" style="margin-top: 12px;"></div>
                                            </div>

                                            <div class="form-group" style="margin-top: 12px;">
                                                <div style="border: 1px dashed #dee2e6; border-radius: 8px; padding: 12px; text-align: center; cursor: pointer; background: white;"
                                                     onclick="document.getElementById('twoWrongPartSentPhotoInput').click()">
                                                    <span style="color: #6c757d; font-size: 14px;">+ Photo of wrong part (optional)</span>
                                                    <input type="file" id="twoWrongPartSentPhotoInput" accept="image/*" capture="environment" style="display: none;" onchange="handleWrongPartSentPhotoUpload(event)">
                                                </div>
                                                <div id="twoWrongPartSentPhotoPreview" style="margin-top: 8px;"></div>
                                            </div>
                                        </div>

                                        <!-- More Work Section - just needs a photo -->
                                        <div id="twoMoreWorkSection" class="hidden" style="margin-bottom: 16px; padding: 16px; background: #e3f2fd; border-radius: 8px; border: 2px solid #2196f3;">
                                            <h4 style="font-size: 15px; font-weight: 700; color: #1565c0; margin-bottom: 12px;">üì∑ Photo the Issue</h4>
                                            <div id="twoMoreWorkPhotoArea" style="border: 2px dashed #2196f3; border-radius: 8px; padding: 20px; text-align: center; cursor: pointer; background: white;"
                                                 onclick="document.getElementById('twoMoreWorkPhotoInput').click()">
                                                <span style="font-size: 28px;">üì∑</span>
                                                <p style="font-weight: 600; color: #1565c0; margin-top: 8px;">Tap to photo the damage/issue</p>
                                                <input type="file" id="twoMoreWorkPhotoInput" accept="image/*" capture="environment" style="display: none;" onchange="handleMoreWorkPhotoUpload(event)">
                                            </div>
                                            <div id="twoMoreWorkPhotoPreview" class="hidden" style="margin-top: 12px;"></div>
                                        </div>

                                        <!-- Notes field -->
                                        <div class="form-group">
                                            <label class="form-label" style="font-weight: 600;">
                                                Notes <span id="twoNotesRequired" style="color: #dc3545;">*Required</span>
                                            </label>
                                            <textarea id="twoNotCompletedDetails" class="form-input" rows="2"
                                                      placeholder="Brief explanation..."
                                                      style="font-size: 16px;"></textarea>
                                        </div>

                                        <button class="btn" onclick="submitJobNotCompleted()"
                                                style="width: 100%; padding: 16px; font-size: 16px; background: #c62828; border-color: #c62828; color: white; margin-top: 16px;">
                                            Close Job
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Unable to Complete Job Modal -->
    <div id="unableToCompleteModal" class="modal hidden">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">Unable to Complete Job</h2>
                <button class="modal-close" onclick="closeUnableToCompleteModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p style="color: #6c757d; margin-bottom: 20px;">Please provide a reason why this job couldn't be completed.</p>

                <div class="form-group">
                    <label class="form-label">Reason *</label>
                    <select id="unableReason" class="form-input">
                        <option value="">Select a reason...</option>
                        <option value="Wrong Part">Wrong Part / Missing Part</option>
                        <option value="Can't Access">Can't Access Site</option>
                        <option value="Additional Work">Additional Work Needed</option>
                        <option value="Equipment Issue">Equipment Issue</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Notes</label>
                    <textarea id="unableNotes" class="form-input" rows="4" placeholder="Provide additional details..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Photo (optional)</label>
                    <input type="file" id="unablePhoto" class="form-input" accept="image/*" onchange="handleUnablePhoto(this)">
                    <div id="unablePhotoPreview" style="margin-top: 12px;"></div>
                </div>

                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <button class="btn btn-outline" onclick="closeUnableToCompleteModal()" style="flex: 1;">Cancel</button>
                    <button class="btn" onclick="submitUnableToComplete()" style="flex: 1; background: #c62828; color: white;">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Estimate Builder - Add Part Modal -->
    <div id="addPartModal" class="modal-backdrop hidden">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h2>Add Part</h2>
                <button class="btn btn-outline" style="padding: 4px 12px;" onclick="closeAddPartModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <input type="text" id="estPartSearch" class="form-input" placeholder="Search parts by name or part number..." oninput="searchPartsForEstimate()" style="width: 100%; margin-bottom: 16px;">
                <div id="estPartsResults" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>

    <!-- Estimate Builder - Add Labor Modal -->
    <div id="addLaborModal" class="modal-backdrop hidden">
        <div class="modal" style="max-width: 400px;">
            <div class="modal-header">
                <h2>Add Labor</h2>
                <button class="btn btn-outline" style="padding: 4px 12px;" onclick="closeAddLaborModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Hours</label>
                    <input type="number" id="addLaborHours" class="form-input" min="0.5" step="0.5" value="1">
                </div>
                <div class="form-group">
                    <label class="form-label">Hourly Rate ($)</label>
                    <input type="number" id="laborRate" class="form-input" min="0" step="1" value="65">
                </div>
                <div class="form-group">
                    <label class="form-label">Description (optional)</label>
                    <input type="text" id="laborDescription" class="form-input" placeholder="e.g., Installation labor">
                </div>
                <div style="margin-top: 20px;">
                    <button class="btn btn-primary" onclick="addLaborFromModal()" style="width: 100%;">Add Labor</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Estimate Builder - Add Custom Item Modal -->
    <div id="addCustomModal" class="modal-backdrop hidden">
        <div class="modal" style="max-width: 450px;">
            <div class="modal-header">
                <h2>Add Custom Item</h2>
                <button class="btn btn-outline" style="padding: 4px 12px;" onclick="closeAddCustomModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Item Name</label>
                    <input type="text" id="customItemName" class="form-input" placeholder="e.g., Special order bracket">
                </div>
                <div class="form-group">
                    <label class="form-label">Description (optional)</label>
                    <textarea id="customItemDesc" class="form-input" rows="2" placeholder="Optional description..."></textarea>
                </div>
                <div style="display: flex; gap: 12px;">
                    <div class="form-group" style="flex: 1;">
                        <label class="form-label">Quantity</label>
                        <input type="number" id="customItemQty" class="form-input" min="1" value="1">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label class="form-label">Unit Price ($)</label>
                        <input type="number" id="customItemPrice" class="form-input" min="0" step="0.01" value="0">
                    </div>
                </div>
                <div style="margin-top: 20px;">
                    <button class="btn btn-primary" onclick="addCustomFromModal()" style="width: 100%;">Add Item</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Work Order Modal -->
    <div id="createWorkOrderModal" class="modal-backdrop hidden">
        <div class="modal" style="max-width: 600px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2>Create Work Order</h2>
                <button class="btn btn-outline" style="padding: 4px 12px;" onclick="closeCreateWorkOrderModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <!-- Job Info (read-only) -->
                <div style="background: #f8f9fa; padding: 12px 16px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <span style="font-weight: 700; color: #0066cc;">Job #</span>
                        <input type="text" id="createWoJobNumber" class="form-input" style="width: 100px;" readonly>
                    </div>
                </div>

                <!-- Customer & Location -->
                <div class="form-group">
                    <label class="form-label">Customer</label>
                    <input type="text" id="createWoCustomerName" class="form-input" readonly style="background: #f8f9fa;">
                </div>
                <div class="form-group">
                    <label class="form-label">Location</label>
                    <input type="text" id="createWoLocationName" class="form-input" readonly style="background: #f8f9fa;">
                </div>
                <div class="form-group">
                    <label class="form-label">Address</label>
                    <input type="text" id="createWoLocationAddress" class="form-input" readonly style="background: #f8f9fa;">
                </div>

                <!-- Job Type -->
                <div class="form-group">
                    <label class="form-label">Job Type</label>
                    <select id="createWoJobType" class="form-input">
                        <option value="repair">Repair</option>
                        <option value="inspection">Inspection</option>
                        <option value="service_call">Service Call</option>
                        <option value="go_see">Go-See</option>
                    </select>
                </div>

                <!-- Description -->
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea id="createWoDescription" class="form-input" rows="3" placeholder="Work to be performed..."></textarea>
                </div>

                <!-- Contact Info -->
                <div style="display: flex; gap: 12px;">
                    <div class="form-group" style="flex: 1;">
                        <label class="form-label">Contact Name</label>
                        <input type="text" id="createWoContactName" class="form-input" placeholder="On-site contact">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label class="form-label">Contact Phone</label>
                        <input type="text" id="createWoContactPhone" class="form-input" placeholder="(xxx) xxx-xxxx">
                    </div>
                </div>

                <!-- Special Instructions -->
                <div class="form-group">
                    <label class="form-label">Special Instructions</label>
                    <textarea id="createWoSpecialInstructions" class="form-input" rows="2" placeholder="Access notes, parking, etc."></textarea>
                </div>

                <!-- Notes -->
                <div class="form-group">
                    <label class="form-label">Internal Notes</label>
                    <textarea id="createWoNotes" class="form-input" rows="2" placeholder="Notes for the team..."></textarea>
                </div>

                <!-- Parts Info -->
                <div style="background: #e3f2fd; padding: 12px 16px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="font-size: 13px; color: #1565c0;" id="createWoPartsInfo">
                        Parts from inspection will be attached
                    </div>
                </div>

                <!-- Submit -->
                <div style="display: flex; gap: 12px;">
                    <button class="btn btn-outline" onclick="closeCreateWorkOrderModal()" style="flex: 1;">Cancel</button>
                    <button class="btn btn-primary" id="createWoSubmitBtn" onclick="submitWorkOrderFromModal()" style="flex: 1; background: #ff9800;">
                        Create Work Order
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Clerk Auth SDK (auto-init sets window.Clerk as instance) -->
    <script
      async crossorigin="anonymous"
      data-clerk-publishable-key="pk_test_bGlrZWQtcmF5LTIxLmNsZXJrLmFjY291bnRzLmRldiQ"
      src="https://liked-ray-21.clerk.accounts.dev/npm/@clerk/clerk-js@5/dist/clerk.browser.js"
      type="text/javascript">
    </script>

    <!-- Data & Constants -->
    <script src="js/data.js"></script>

    <!-- View modules -->
    <script src="js/views/inspection.js"></script>
    <script src="js/views/office.js"></script>
    <script src="js/views/field.js"></script>
    <script src="js/views/dashboard.js"></script>
    <script src="js/views/estimate-builder.js"></script>
    <script src="js/views/ops-review.js"></script>
    <script src="js/views/scheduling.js"></script>
    <script src="js/views/create.js"></script>
    <script src="js/views/my-jobs.js"></script>
    <script src="js/views/admin.js"></script>

    <!-- Utilities -->
    <script src="js/utils/search.js"></script>
    <script src="js/utils/parts-api.js"></script>
    <script src="js/utils/jobs-api.js"></script>
    <script src="js/utils/estimates-api.js"></script>
    <script src="js/utils/customers-api.js"></script>
    <script src="js/utils/parts-catalog.js"></script>

    <!-- App core (load last - kicks off init) -->
    <script src="js/app.js"></script>

    <!-- Clerk auth (after app.js so login() is available) -->
    <script src="js/auth.js"></script>
</body>
</html>
